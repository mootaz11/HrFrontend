/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, EventEmitter, forwardRef, Input, Output, ContentChild, TemplateRef } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DAY_NAMES } from '../../models/day-names';
import { MonthView } from '../../models/views/moth-view';
import { DayTemplateDirective } from '../../directives/day-template.directive';
import { DayOfWeekCaptionTemplateDirective } from '../../directives/day-of-week-caption-template.directive';
import { MonthCaptionTemplateDirective } from '../../directives/month-caption-template.directive';
import { DayOfWeek } from '../../models/day-of-week';
import { defaultDayOfWeekCaptionFormatterFactory } from '../../models/formatters/day-of-week-caption-formatter';
/** *
 * Month calendar provider.
  @type {?} */
export var MONTH_CALENDAR_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(function () { return MonthCalendarComponent; }),
    multi: true
};
/**
 * Control that represents a calendar.
 */
var MonthCalendarComponent = /** @class */ (function () {
    function MonthCalendarComponent() {
        /**
         * Event raised when the user selects a date.
         */
        this.change = new EventEmitter();
        /**
         * Event raised when the user clicks the calendar.
         */
        this.monthClick = new EventEmitter();
        /**
         * Sets if the control should be in a
         * disabled state.
         */
        this.disabled = false;
        /**
         * Date to show.
         */
        this._value = new Date();
        /**
         * Specifies how a day cell should grow.
         */
        this._grow = { mode: 'stretch' };
        this.defaultFirstDayOfWeek = DayOfWeek.Sunday;
        this.defaultDayOfWeekCaptionFormatter = defaultDayOfWeekCaptionFormatterFactory(this.defaultFirstDayOfWeek);
        /**
         * First day of the week.
         */
        this._firstDayOfWeek = this.defaultFirstDayOfWeek;
        /**
         * CSS class for the month.
         */
        this.monthClass = 'sc-month';
        /**
         * CSS class for the disabled state.
         */
        this.disabledClass = 'sc-month--disabled';
        /**
         * CSS class for the month caption.
         */
        this.monthCaptionClass = 'sc-month__caption';
        /**
         * CSS class for the day of the week captions.
         */
        this.dayOfWeekCaptionClass = 'sc-month__week-caption';
        /**
         * CSS class for the day captions.
         */
        this.dayCaptionClass = 'sc-month__day';
        /**
         * CSS class for the current day.
         */
        this.currentDayClass = 'sc-month__day--today';
        /**
         * CSS class for the day when the state is disabled.
         */
        this.disabledDayClass = 'sc-month__day--disabled';
        /**
         * CSS class for the selected day.
         */
        this.selectedDayClass = 'sc-month__day--selected';
        this.defaultMonthCaptionFormatter = function (date) { return date.toDateString(); };
        this.defaultDayFormatter = function (day) { return day ? day.day.toString() : ''; };
        this.onChange = function (date) { };
        this.onTouched = function () { };
    }
    Object.defineProperty(MonthCalendarComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} date
         * @return {?}
         */
        function (date) {
            this.writeValue(date);
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MonthCalendarComponent.prototype, "grow", {
        get: /**
         * @return {?}
         */
        function () {
            return this._grow;
        },
        set: /**
         * @param {?} mode
         * @return {?}
         */
        function (mode) {
            if (mode) {
                this._grow = mode;
            }
            else {
                this._grow = { mode: 'stretch' };
            }
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MonthCalendarComponent.prototype, "firstDayOfWeek", {
        get: /**
         * @return {?}
         */
        function () {
            return this._firstDayOfWeek;
        },
        set: /**
         * @param {?} dayOfWeek
         * @return {?}
         */
        function (dayOfWeek) {
            this._firstDayOfWeek = dayOfWeek;
            this.defaultDayOfWeekCaptionFormatter = defaultDayOfWeekCaptionFormatterFactory(this._firstDayOfWeek);
            this.refresh();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MonthCalendarComponent.prototype, "dayFormatter", {
        get: /**
         * @return {?}
         */
        function () {
            return this._dayFormatter;
        },
        set: /**
         * @param {?} formatter
         * @return {?}
         */
        function (formatter) {
            this._dayFormatter = formatter;
            this.refresh();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MonthCalendarComponent.prototype, "dayOfWeekCaptionFormatter", {
        get: /**
         * @return {?}
         */
        function () {
            return this._dayOfWeekCaptionFormatter;
        },
        set: /**
         * @param {?} formatter
         * @return {?}
         */
        function (formatter) {
            this._dayOfWeekCaptionFormatter = formatter;
            this.refresh();
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(MonthCalendarComponent.prototype, "monthCaptionFormatter", {
        get: /**
         * @return {?}
         */
        function () {
            return this._monthCaptionFormatter;
        },
        set: /**
         * @param {?} formatter
         * @return {?}
         */
        function (formatter) {
            this._monthCaptionFormatter = formatter;
            this.refresh();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * Initializes the component.
     */
    /**
     * Initializes the component.
     * @return {?}
     */
    MonthCalendarComponent.prototype.ngOnInit = /**
     * Initializes the component.
     * @return {?}
     */
    function () {
        this.refresh();
    };
    /**
     * @param {?} date
     * @return {?}
     */
    MonthCalendarComponent.prototype.writeValue = /**
     * @param {?} date
     * @return {?}
     */
    function (date) {
        if (date) {
            this._value = date;
            this.refresh();
            this.onChange(date);
        }
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    MonthCalendarComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    MonthCalendarComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    MonthCalendarComponent.prototype.setDisabledState = /**
     * @param {?} isDisabled
     * @return {?}
     */
    function (isDisabled) {
        this.disabled = isDisabled;
    };
    /**
     * Refreshes the component.
     * @return {?}
     */
    MonthCalendarComponent.prototype.refresh = /**
     * Refreshes the component.
     * @return {?}
     */
    function () {
        this.refreshMonthCaption(this.value);
        this.refreshDayOfWeekCaptions();
        this.refreshView(this.value);
    };
    /**
     * Refreshes the month caption.
     * @param {?} date Date.
     * @return {?}
     */
    MonthCalendarComponent.prototype.refreshMonthCaption = /**
     * Refreshes the month caption.
     * @param {?} date Date.
     * @return {?}
     */
    function (date) {
        if (this.monthCaptionFormatter) {
            this.monthCaption = this.monthCaptionFormatter(date);
        }
        else {
            this.monthCaption = this.defaultMonthCaptionFormatter(date);
        }
    };
    /**
     * Refreshes the day of week captions.
     * @return {?}
     */
    MonthCalendarComponent.prototype.refreshDayOfWeekCaptions = /**
     * Refreshes the day of week captions.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var dayCaptions = [];
        /** @type {?} */
        var dayOfWeekFormatter = this.dayOfWeekCaptionFormatter ?
            this.dayOfWeekCaptionFormatter :
            this.defaultDayOfWeekCaptionFormatter;
        for (var i = 0; i < DAY_NAMES.length; i++) {
            dayCaptions.push(dayOfWeekFormatter(i));
        }
        this.daysOfWeekCaptions = dayCaptions;
    };
    /**
     * Refreshes the calendar view.
     * @param {?} date Date.
     * @return {?}
     */
    MonthCalendarComponent.prototype.refreshView = /**
     * Refreshes the calendar view.
     * @param {?} date Date.
     * @return {?}
     */
    function (date) {
        this.view = new MonthView(date).createView(false, this.firstDayOfWeek);
    };
    /**
     * Gets the CSS classes to apply to the month.
     */
    /**
     * Gets the CSS classes to apply to the month.
     * @return {?}
     */
    MonthCalendarComponent.prototype.getClassForMonth = /**
     * Gets the CSS classes to apply to the month.
     * @return {?}
     */
    function () {
        /** @type {?} */
        var classesToApply = this.monthClass;
        if (this.disabled) {
            classesToApply = this.monthClass + ' ' + this.disabledClass;
        }
        return classesToApply;
    };
    /**
     * Gets the CSS class applicable to
     * the specified day.
     * @param day Day.
     */
    /**
     * Gets the CSS class applicable to
     * the specified day.
     * @param {?=} day Day.
     * @return {?}
     */
    MonthCalendarComponent.prototype.getClassForDay = /**
     * Gets the CSS class applicable to
     * the specified day.
     * @param {?=} day Day.
     * @return {?}
     */
    function (day) {
        /** @type {?} */
        var dayClassToApply = '';
        if (day) {
            if (day.day === this.value.getDate()) {
                dayClassToApply = this.selectedDayClass;
            }
            else if (day.isToday) {
                dayClassToApply = this.currentDayClass;
            }
            else if (this.customDayClass) {
                /** @type {?} */
                var date = new Date(this.value.valueOf());
                date.setDate(day.day);
                dayClassToApply = this.customDayClass(day);
            }
            if (this.disabled) {
                dayClassToApply = dayClassToApply + ' ' + this.disabledDayClass;
            }
            return this.dayCaptionClass + ' ' + dayClassToApply;
        }
        else {
            return this.dayCaptionClass;
        }
    };
    /**
     * Gets a formatted string corresponding
     * to the specified day.
     * @param day Day to format.
     */
    /**
     * Gets a formatted string corresponding
     * to the specified day.
     * @param {?} day Day to format.
     * @return {?}
     */
    MonthCalendarComponent.prototype.getFormattedDay = /**
     * Gets a formatted string corresponding
     * to the specified day.
     * @param {?} day Day to format.
     * @return {?}
     */
    function (day) {
        if (this.dayFormatter) {
            return this.dayFormatter(day);
        }
        else {
            return this.defaultDayFormatter(day);
        }
    };
    /**
     * Controls the click event of a day cell.
     * @param dayInfo Info about the selected day.
     */
    /**
     * Controls the click event of a day cell.
     * @param {?} dayInfo Info about the selected day.
     * @return {?}
     */
    MonthCalendarComponent.prototype.onDayClick = /**
     * Controls the click event of a day cell.
     * @param {?} dayInfo Info about the selected day.
     * @return {?}
     */
    function (dayInfo) {
        if (!this.disabled && dayInfo) {
            /** @type {?} */
            var selectedDate = new Date(this.value.valueOf());
            selectedDate.setDate(dayInfo.day);
            this.value = new Date(selectedDate.valueOf());
            this.change.emit(selectedDate);
        }
    };
    /**
     * Controls the click event of the month.
     */
    /**
     * Controls the click event of the month.
     * @return {?}
     */
    MonthCalendarComponent.prototype.onMonthClick = /**
     * Controls the click event of the month.
     * @return {?}
     */
    function () {
        if (!this.disabled) {
            this.monthClick.emit(this);
        }
    };
    MonthCalendarComponent.decorators = [
        { type: Component, args: [{
                    selector: 'sc-month-calendar',
                    template: "<!-- Month -->\n<div (click)=\"onMonthClick()\"\n     [ngClass]=\"['column', grow.mode == 'stretch' ? 'stretch-vertically' : '', getClassForMonth()]\">\n\n  <!-- Month caption -->\n  <div class=\"row\">\n\n    <!-- Month caption cell -->\n    <div class=\"w-100\"\n         [class.label]=\"grow.mode != 'mixed'\"\n         [class.ratio-height]=\"grow.mode == 'proportional'\"\n         [class.stretch-horizontally]=\"grow.mode == 'stretch' || grow.mode == 'mixed'\">\n\n      <!-- Month caption cell content -->\n      <div [class.label__content]=\"grow.mode != 'mixed'\">\n\n        <ng-container *ngTemplateOutlet=\"monthTemplate ? monthTemplate : defaultMonthTemplate; context: { $implicit: value }\"></ng-container>\n\n      </div>\n    </div>\n  </div>\n\n  <!-- Week captions -->\n  <div class=\"row\">\n\n    <!-- Week captions cell -->\n    <div [class.label]=\"grow.mode != 'mixed'\"\n         [class.ratio-square]=\"grow.mode == 'proportional'\"\n         [class.stretch-horizontally]=\"grow.mode == 'stretch' || grow.mode == 'mixed'\"\n         *ngFor=\"let dayOfWeekCaption of daysOfWeekCaptions; let i = index\">\n\n      <!-- Week caption cell content -->\n      <div [class.label__content]=\"grow.mode != 'mixed'\">\n\n        <ng-container *ngTemplateOutlet=\"dayOfWeekTemplate ? dayOfWeekTemplate : defaultDayOfWeekTemplate; context: { $implicit: dayOfWeekCaption, dayOfWeekIndex: i }\"></ng-container>\n\n      </div>\n    </div>\n  </div>\n\n  <!-- Days -->\n  <div class=\"row\"\n       *ngFor=\"let week of view\">\n\n    <!-- Day cell -->\n    <div (click)=\"onDayClick(day)\"\n         class=\"ratio-square label\"\n         [class.ratio-square]=\"grow.mode == 'proportional' || grow.mode == 'mixed'\"\n         [class.stretch-horizontally]=\"grow.mode == 'stretch'\"\n         *ngFor=\"let day of week\">\n\n      <!-- Day content -->\n      <div class=\"label__content\">\n\n        <ng-container *ngTemplateOutlet=\"dayTemplate ? dayTemplate : defaultDayTemplate; context: { $implicit: day }\"></ng-container>\n\n      </div>\n\n    </div>\n\n  </div>\n\n</div>\n\n\n\n<!-- Templates -->\n\n<!-- Day template -->\n<ng-template #defaultDayTemplate\n             let-day>\n  <div class=\"flex-expanded-container\">\n    <div [ngClass]=\"['flex-expand', getClassForDay(day)]\">{{ getFormattedDay(day) }}</div>\n  </div>\n</ng-template>\n\n<!-- Day of week cells template -->\n<ng-template #defaultDayOfWeekTemplate\n             let-dayOfWeek\n             let-dayOfWeekIndex=\"dayOfWeekIndex\">\n  <div [class.flex-expanded-container]=\"grow.mode != 'mixed'\">\n    <div [ngClass]=\"['flex-expand', 'flex-centered', dayOfWeekCaptionClass]\">\n      {{ dayOfWeek }}\n    </div>\n  </div>\n</ng-template>\n\n<!-- Month cell template -->\n<ng-template #defaultMonthTemplate\n             let-date>\n  <div [class.flex-expanded-container]=\"grow.mode != 'mixed'\">\n    <div [ngClass]=\"['flex-expand', 'flex-centered', monthCaptionClass]\">\n      {{ monthCaption }}\n    </div>\n  </div>\n</ng-template>\n",
                    styles: [".column{display:flex;flex-flow:column;flex:1}.row{display:flex;flex:1}.label{position:relative}.label__content{position:absolute;top:0;left:0;bottom:0;right:0}.flex-expanded-container{display:flex;position:absolute;width:100%;height:100%}.flex-expand{flex:1}.flex-centered{display:flex;align-items:center;justify-content:center}.ratio-height{padding-bottom:14.28571%}.ratio-square{padding-bottom:14.28571%;width:14.28571%}.stretch-vertically{height:100%}.stretch-horizontally{width:14.28571%}.fixed-height{display:flex;flex:1}.w-100{width:100%}.sc-month{font-size:2rem}.sc-month--disabled{opacity:.25}.sc-month__caption,.sc-month__week-caption{border:1px solid #000;font-weight:700}.sc-month__day{border:1px solid #000;cursor:pointer}.sc-month__day--disabled{cursor:auto}.sc-month__day--today{background:pink}.sc-month__day--selected{background:#6495ed}"],
                    providers: [MONTH_CALENDAR_VALUE_ACCESSOR]
                },] },
    ];
    MonthCalendarComponent.propDecorators = {
        dayTemplate: [{ type: ContentChild, args: [DayTemplateDirective, { read: TemplateRef },] }],
        dayOfWeekTemplate: [{ type: ContentChild, args: [DayOfWeekCaptionTemplateDirective, { read: TemplateRef },] }],
        monthTemplate: [{ type: ContentChild, args: [MonthCaptionTemplateDirective, { read: TemplateRef },] }],
        change: [{ type: Output, args: ['change',] }],
        monthClick: [{ type: Output, args: ['monthClick',] }],
        disabled: [{ type: Input }],
        value: [{ type: Input }],
        grow: [{ type: Input }],
        firstDayOfWeek: [{ type: Input }],
        dayFormatter: [{ type: Input }],
        dayOfWeekCaptionFormatter: [{ type: Input }],
        monthCaptionFormatter: [{ type: Input }],
        customDayClass: [{ type: Input }],
        monthClass: [{ type: Input }],
        disabledClass: [{ type: Input }],
        monthCaptionClass: [{ type: Input }],
        dayOfWeekCaptionClass: [{ type: Input }],
        dayCaptionClass: [{ type: Input }],
        currentDayClass: [{ type: Input }],
        disabledDayClass: [{ type: Input }],
        selectedDayClass: [{ type: Input }]
    };
    return MonthCalendarComponent;
}());
export { MonthCalendarComponent };
if (false) {
    /** @type {?} */
    MonthCalendarComponent.prototype.dayTemplate;
    /** @type {?} */
    MonthCalendarComponent.prototype.dayOfWeekTemplate;
    /** @type {?} */
    MonthCalendarComponent.prototype.monthTemplate;
    /**
     * Event raised when the user selects a date.
     * @type {?}
     */
    MonthCalendarComponent.prototype.change;
    /**
     * Event raised when the user clicks the calendar.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthClick;
    /**
     * Sets if the control should be in a
     * disabled state.
     * @type {?}
     */
    MonthCalendarComponent.prototype.disabled;
    /**
     * Date to show.
     * @type {?}
     */
    MonthCalendarComponent.prototype._value;
    /**
     * Specifies how a day cell should grow.
     * @type {?}
     */
    MonthCalendarComponent.prototype._grow;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultFirstDayOfWeek;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultDayOfWeekCaptionFormatter;
    /**
     * First day of the week.
     * @type {?}
     */
    MonthCalendarComponent.prototype._firstDayOfWeek;
    /**
     * Formatter for days.
     * @type {?}
     */
    MonthCalendarComponent.prototype._dayFormatter;
    /**
     * Captions of the different days of the week.
     * @type {?}
     */
    MonthCalendarComponent.prototype.daysOfWeekCaptions;
    /**
     * Formatter for the captions of the different
     * days of the week.
     * @type {?}
     */
    MonthCalendarComponent.prototype._dayOfWeekCaptionFormatter;
    /**
     * Caption of the month.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthCaption;
    /**
     * Formatter for the month caption.
     * @type {?}
     */
    MonthCalendarComponent.prototype._monthCaptionFormatter;
    /**
     * Retrieves a CSS class for the specified day.
     * @type {?}
     */
    MonthCalendarComponent.prototype.customDayClass;
    /**
     * CSS class for the month.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthClass;
    /**
     * CSS class for the disabled state.
     * @type {?}
     */
    MonthCalendarComponent.prototype.disabledClass;
    /**
     * CSS class for the month caption.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthCaptionClass;
    /**
     * CSS class for the day of the week captions.
     * @type {?}
     */
    MonthCalendarComponent.prototype.dayOfWeekCaptionClass;
    /**
     * CSS class for the day captions.
     * @type {?}
     */
    MonthCalendarComponent.prototype.dayCaptionClass;
    /**
     * CSS class for the current day.
     * @type {?}
     */
    MonthCalendarComponent.prototype.currentDayClass;
    /**
     * CSS class for the day when the state is disabled.
     * @type {?}
     */
    MonthCalendarComponent.prototype.disabledDayClass;
    /**
     * CSS class for the selected day.
     * @type {?}
     */
    MonthCalendarComponent.prototype.selectedDayClass;
    /**
     * View of the current month.
     * @type {?}
     */
    MonthCalendarComponent.prototype.view;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultMonthCaptionFormatter;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultDayFormatter;
    /** @type {?} */
    MonthCalendarComponent.prototype.onChange;
    /** @type {?} */
    MonthCalendarComponent.prototype.onTouched;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9udGgtY2FsZW5kYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vc2ltcGxlLWFuZ3VsYXItY2FsZW5kYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9tb250aC1jYWxlbmRhci9tb250aC1jYWxlbmRhci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBZSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFDbkksT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXpFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDekQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0seURBQXlELENBQUM7QUFDNUcsT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sbURBQW1ELENBQUM7QUFDbEcsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JELE9BQU8sRUFBRSx1Q0FBdUMsRUFBRSxNQUFNLHVEQUF1RCxDQUFDOzs7O0FBTWhILFdBQWEsNkJBQTZCLEdBQVE7SUFDaEQsT0FBTyxFQUFFLGlCQUFpQjtJQUMxQixXQUFXLEVBQUUsVUFBVSxDQUFDLGNBQU0sT0FBQSxzQkFBc0IsRUFBdEIsQ0FBc0IsQ0FBQztJQUNyRCxLQUFLLEVBQUUsSUFBSTtDQUNaLENBQUM7Ozs7Ozs7OztzQkFtSDJCLElBQUksWUFBWSxFQUFROzs7OzBCQUtoQixJQUFJLFlBQVksRUFBMEI7Ozs7O3dCQU16RCxLQUFLOzs7O3NCQUtSLElBQUksSUFBSSxFQUFFOzs7O3FCQWFELEVBQUUs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IjpbImltcG9ydCB7IENvbXBvbmVudCwgRXZlbnRFbWl0dGVyLCBmb3J3YXJkUmVmLCBIb3N0QmluZGluZywgSW5wdXQsIE91dHB1dCwgQ29udGVudENoaWxkLCBUZW1wbGF0ZVJlZiwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5pbXBvcnQgeyBEYXlJbmZvIH0gZnJvbSAnLi4vLi4vbW9kZWxzL2RheS1pbmZvJztcbmltcG9ydCB7IERBWV9OQU1FUyB9IGZyb20gJy4uLy4uL21vZGVscy9kYXktbmFtZXMnO1xuaW1wb3J0IHsgTW9udGhWaWV3IH0gZnJvbSAnLi4vLi4vbW9kZWxzL3ZpZXdzL21vdGgtdmlldyc7XG5pbXBvcnQgeyBEYXlUZW1wbGF0ZURpcmVjdGl2ZSB9IGZyb20gJy4uLy4uL2RpcmVjdGl2ZXMvZGF5LXRlbXBsYXRlLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBEYXlPZldlZWtDYXB0aW9uVGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2RheS1vZi13ZWVrLWNhcHRpb24tdGVtcGxhdGUuZGlyZWN0aXZlJztcbmltcG9ydCB7IE1vbnRoQ2FwdGlvblRlbXBsYXRlRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vZGlyZWN0aXZlcy9tb250aC1jYXB0aW9uLXRlbXBsYXRlLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBEYXlPZldlZWsgfSBmcm9tICcuLi8uLi9tb2RlbHMvZGF5LW9mLXdlZWsnO1xuaW1wb3J0IHsgZGVmYXVsdERheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXJGYWN0b3J5IH0gZnJvbSAnLi4vLi4vbW9kZWxzL2Zvcm1hdHRlcnMvZGF5LW9mLXdlZWstY2FwdGlvbi1mb3JtYXR0ZXInO1xuaW1wb3J0IHsgR3Jvd01vZGUgfSBmcm9tICcuLi8uLi9tb2RlbHMvZ3Jvdy1tb2RlJztcblxuLyoqXG4gKiBNb250aCBjYWxlbmRhciBwcm92aWRlci5cbiAqL1xuZXhwb3J0IGNvbnN0IE1PTlRIX0NBTEVOREFSX1ZBTFVFX0FDQ0VTU09SOiBhbnkgPSB7XG4gIHByb3ZpZGU6IE5HX1ZBTFVFX0FDQ0VTU09SLFxuICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBNb250aENhbGVuZGFyQ29tcG9uZW50KSxcbiAgbXVsdGk6IHRydWVcbn07XG5cbi8qKlxuICogQ29udHJvbCB0aGF0IHJlcHJlc2VudHMgYSBjYWxlbmRhci5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnc2MtbW9udGgtY2FsZW5kYXInLFxuICB0ZW1wbGF0ZTogYDwhLS0gTW9udGggLS0+XG48ZGl2IChjbGljayk9XCJvbk1vbnRoQ2xpY2soKVwiXG4gICAgIFtuZ0NsYXNzXT1cIlsnY29sdW1uJywgZ3Jvdy5tb2RlID09ICdzdHJldGNoJyA/ICdzdHJldGNoLXZlcnRpY2FsbHknIDogJycsIGdldENsYXNzRm9yTW9udGgoKV1cIj5cblxuICA8IS0tIE1vbnRoIGNhcHRpb24gLS0+XG4gIDxkaXYgY2xhc3M9XCJyb3dcIj5cblxuICAgIDwhLS0gTW9udGggY2FwdGlvbiBjZWxsIC0tPlxuICAgIDxkaXYgY2xhc3M9XCJ3LTEwMFwiXG4gICAgICAgICBbY2xhc3MubGFiZWxdPVwiZ3Jvdy5tb2RlICE9ICdtaXhlZCdcIlxuICAgICAgICAgW2NsYXNzLnJhdGlvLWhlaWdodF09XCJncm93Lm1vZGUgPT0gJ3Byb3BvcnRpb25hbCdcIlxuICAgICAgICAgW2NsYXNzLnN0cmV0Y2gtaG9yaXpvbnRhbGx5XT1cImdyb3cubW9kZSA9PSAnc3RyZXRjaCcgfHwgZ3Jvdy5tb2RlID09ICdtaXhlZCdcIj5cblxuICAgICAgPCEtLSBNb250aCBjYXB0aW9uIGNlbGwgY29udGVudCAtLT5cbiAgICAgIDxkaXYgW2NsYXNzLmxhYmVsX19jb250ZW50XT1cImdyb3cubW9kZSAhPSAnbWl4ZWQnXCI+XG5cbiAgICAgICAgPG5nLWNvbnRhaW5lciAqbmdUZW1wbGF0ZU91dGxldD1cIm1vbnRoVGVtcGxhdGUgPyBtb250aFRlbXBsYXRlIDogZGVmYXVsdE1vbnRoVGVtcGxhdGU7IGNvbnRleHQ6IHsgJGltcGxpY2l0OiB2YWx1ZSB9XCI+PC9uZy1jb250YWluZXI+XG5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICA8L2Rpdj5cblxuICA8IS0tIFdlZWsgY2FwdGlvbnMgLS0+XG4gIDxkaXYgY2xhc3M9XCJyb3dcIj5cblxuICAgIDwhLS0gV2VlayBjYXB0aW9ucyBjZWxsIC0tPlxuICAgIDxkaXYgW2NsYXNzLmxhYmVsXT1cImdyb3cubW9kZSAhPSAnbWl4ZWQnXCJcbiAgICAgICAgIFtjbGFzcy5yYXRpby1zcXVhcmVdPVwiZ3Jvdy5tb2RlID09ICdwcm9wb3J0aW9uYWwnXCJcbiAgICAgICAgIFtjbGFzcy5zdHJldGNoLWhvcml6b250YWxseV09XCJncm93Lm1vZGUgPT0gJ3N0cmV0Y2gnIHx8IGdyb3cubW9kZSA9PSAnbWl4ZWQnXCJcbiAgICAgICAgICpuZ0Zvcj1cImxldCBkYXlPZldlZWtDYXB0aW9uIG9mIGRheXNPZldlZWtDYXB0aW9uczsgbGV0IGkgPSBpbmRleFwiPlxuXG4gICAgICA8IS0tIFdlZWsgY2FwdGlvbiBjZWxsIGNvbnRlbnQgLS0+XG4gICAgICA8ZGl2IFtjbGFzcy5sYWJlbF9fY29udGVudF09XCJncm93Lm1vZGUgIT0gJ21peGVkJ1wiPlxuXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJkYXlPZldlZWtUZW1wbGF0ZSA/IGRheU9mV2Vla1RlbXBsYXRlIDogZGVmYXVsdERheU9mV2Vla1RlbXBsYXRlOyBjb250ZXh0OiB7ICRpbXBsaWNpdDogZGF5T2ZXZWVrQ2FwdGlvbiwgZGF5T2ZXZWVrSW5kZXg6IGkgfVwiPjwvbmctY29udGFpbmVyPlxuXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5cbiAgPCEtLSBEYXlzIC0tPlxuICA8ZGl2IGNsYXNzPVwicm93XCJcbiAgICAgICAqbmdGb3I9XCJsZXQgd2VlayBvZiB2aWV3XCI+XG5cbiAgICA8IS0tIERheSBjZWxsIC0tPlxuICAgIDxkaXYgKGNsaWNrKT1cIm9uRGF5Q2xpY2soZGF5KVwiXG4gICAgICAgICBjbGFzcz1cInJhdGlvLXNxdWFyZSBsYWJlbFwiXG4gICAgICAgICBbY2xhc3MucmF0aW8tc3F1YXJlXT1cImdyb3cubW9kZSA9PSAncHJvcG9ydGlvbmFsJyB8fCBncm93Lm1vZGUgPT0gJ21peGVkJ1wiXG4gICAgICAgICBbY2xhc3Muc3RyZXRjaC1ob3Jpem9udGFsbHldPVwiZ3Jvdy5tb2RlID09ICdzdHJldGNoJ1wiXG4gICAgICAgICAqbmdGb3I9XCJsZXQgZGF5IG9mIHdlZWtcIj5cblxuICAgICAgPCEtLSBEYXkgY29udGVudCAtLT5cbiAgICAgIDxkaXYgY2xhc3M9XCJsYWJlbF9fY29udGVudFwiPlxuXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJkYXlUZW1wbGF0ZSA/IGRheVRlbXBsYXRlIDogZGVmYXVsdERheVRlbXBsYXRlOyBjb250ZXh0OiB7ICRpbXBsaWNpdDogZGF5IH1cIj48L25nLWNvbnRhaW5lcj5cblxuICAgICAgPC9kaXY+XG5cbiAgICA8L2Rpdj5cblxuICA8L2Rpdj5cblxuPC9kaXY+XG5cblxuXG48IS0tIFRlbXBsYXRlcyAtLT5cblxuPCEtLSBEYXkgdGVtcGxhdGUgLS0+XG48bmctdGVtcGxhdGUgI2RlZmF1bHREYXlUZW1wbGF0ZVxuICAgICAgICAgICAgIGxldC1kYXk+XG4gIDxkaXYgY2xhc3M9XCJmbGV4LWV4cGFuZGVkLWNvbnRhaW5lclwiPlxuICAgIDxkaXYgW25nQ2xhc3NdPVwiWydmbGV4LWV4cGFuZCcsIGdldENsYXNzRm9yRGF5KGRheSldXCI+e3sgZ2V0Rm9ybWF0dGVkRGF5KGRheSkgfX08L2Rpdj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuXG48IS0tIERheSBvZiB3ZWVrIGNlbGxzIHRlbXBsYXRlIC0tPlxuPG5nLXRlbXBsYXRlICNkZWZhdWx0RGF5T2ZXZWVrVGVtcGxhdGVcbiAgICAgICAgICAgICBsZXQtZGF5T2ZXZWVrXG4gICAgICAgICAgICAgbGV0LWRheU9mV2Vla0luZGV4PVwiZGF5T2ZXZWVrSW5kZXhcIj5cbiAgPGRpdiBbY2xhc3MuZmxleC1leHBhbmRlZC1jb250YWluZXJdPVwiZ3Jvdy5tb2RlICE9ICdtaXhlZCdcIj5cbiAgICA8ZGl2IFtuZ0NsYXNzXT1cIlsnZmxleC1leHBhbmQnLCAnZmxleC1jZW50ZXJlZCcsIGRheU9mV2Vla0NhcHRpb25DbGFzc11cIj5cbiAgICAgIHt7IGRheU9mV2VlayB9fVxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5cbjwhLS0gTW9udGggY2VsbCB0ZW1wbGF0ZSAtLT5cbjxuZy10ZW1wbGF0ZSAjZGVmYXVsdE1vbnRoVGVtcGxhdGVcbiAgICAgICAgICAgICBsZXQtZGF0ZT5cbiAgPGRpdiBbY2xhc3MuZmxleC1leHBhbmRlZC1jb250YWluZXJdPVwiZ3Jvdy5tb2RlICE9ICdtaXhlZCdcIj5cbiAgICA8ZGl2IFtuZ0NsYXNzXT1cIlsnZmxleC1leHBhbmQnLCAnZmxleC1jZW50ZXJlZCcsIG1vbnRoQ2FwdGlvbkNsYXNzXVwiPlxuICAgICAge3sgbW9udGhDYXB0aW9uIH19XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cbmAsXG4gIHN0eWxlczogW2AuY29sdW1ue2Rpc3BsYXk6ZmxleDtmbGV4LWZsb3c6Y29sdW1uO2ZsZXg6MX0ucm93e2Rpc3BsYXk6ZmxleDtmbGV4OjF9LmxhYmVse3Bvc2l0aW9uOnJlbGF0aXZlfS5sYWJlbF9fY29udGVudHtwb3NpdGlvbjphYnNvbHV0ZTt0b3A6MDtsZWZ0OjA7Ym90dG9tOjA7cmlnaHQ6MH0uZmxleC1leHBhbmRlZC1jb250YWluZXJ7ZGlzcGxheTpmbGV4O3Bvc2l0aW9uOmFic29sdXRlO3dpZHRoOjEwMCU7aGVpZ2h0OjEwMCV9LmZsZXgtZXhwYW5ke2ZsZXg6MX0uZmxleC1jZW50ZXJlZHtkaXNwbGF5OmZsZXg7YWxpZ24taXRlbXM6Y2VudGVyO2p1c3RpZnktY29udGVudDpjZW50ZXJ9LnJhdGlvLWhlaWdodHtwYWRkaW5nLWJvdHRvbToxNC4yODU3MSV9LnJhdGlvLXNxdWFyZXtwYWRkaW5nLWJvdHRvbToxNC4yODU3MSU7d2lkdGg6MTQuMjg1NzElfS5zdHJldGNoLXZlcnRpY2FsbHl7aGVpZ2h0OjEwMCV9LnN0cmV0Y2gtaG9yaXpvbnRhbGx5e3dpZHRoOjE0LjI4NTcxJX0uZml4ZWQtaGVpZ2h0e2Rpc3BsYXk6ZmxleDtmbGV4OjF9LnctMTAwe3dpZHRoOjEwMCV9LnNjLW1vbnRoe2ZvbnQtc2l6ZToycmVtfS5zYy1tb250aC0tZGlzYWJsZWR7b3BhY2l0eTouMjV9LnNjLW1vbnRoX19jYXB0aW9uLC5zYy1tb250aF9fd2Vlay1jYXB0aW9ue2JvcmRlcjoxcHggc29saWQgIzAwMDtmb250LXdlaWdodDo3MDB9LnNjLW1vbnRoX19kYXl7Ym9yZGVyOjFweCBzb2xpZCAjMDAwO2N1cnNvcjpwb2ludGVyfS5zYy1tb250aF9fZGF5LS1kaXNhYmxlZHtjdXJzb3I6YXV0b30uc2MtbW9udGhfX2RheS0tdG9kYXl7YmFja2dyb3VuZDpwaW5rfS5zYy1tb250aF9fZGF5LS1zZWxlY3RlZHtiYWNrZ3JvdW5kOiM2NDk1ZWR9YF0sXG4gIHByb3ZpZGVyczogW01PTlRIX0NBTEVOREFSX1ZBTFVFX0FDQ0VTU09SXVxufSlcbmV4cG9ydCBjbGFzcyBNb250aENhbGVuZGFyQ29tcG9uZW50IGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE9uSW5pdCB7XG4gIEBDb250ZW50Q2hpbGQoRGF5VGVtcGxhdGVEaXJlY3RpdmUsIHsgcmVhZDogVGVtcGxhdGVSZWYgfSkgZGF5VGVtcGxhdGU7XG4gIEBDb250ZW50Q2hpbGQoRGF5T2ZXZWVrQ2FwdGlvblRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pIGRheU9mV2Vla1RlbXBsYXRlO1xuICBAQ29udGVudENoaWxkKE1vbnRoQ2FwdGlvblRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pIG1vbnRoVGVtcGxhdGU7XG5cbiAgLyoqXG4gICAqIEV2ZW50IHJhaXNlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYSBkYXRlLlxuICAgKi9cbiAgQE91dHB1dCgnY2hhbmdlJykgY2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxEYXRlPigpO1xuXG4gIC8qKlxuICAgKiBFdmVudCByYWlzZWQgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlIGNhbGVuZGFyLlxuICAgKi9cbiAgQE91dHB1dCgnbW9udGhDbGljaycpIG1vbnRoQ2xpY2sgPSBuZXcgRXZlbnRFbWl0dGVyPE1vbnRoQ2FsZW5kYXJDb21wb25lbnQ+KCk7XG5cbiAgLyoqXG4gICAqIFNldHMgaWYgdGhlIGNvbnRyb2wgc2hvdWxkIGJlIGluIGFcbiAgICogZGlzYWJsZWQgc3RhdGUuXG4gICAqL1xuICBASW5wdXQoKSBkaXNhYmxlZCA9IGZhbHNlO1xuXG4gIC8qKlxuICAgKiBEYXRlIHRvIHNob3cuXG4gICAqL1xuICBwcml2YXRlIF92YWx1ZSA9IG5ldyBEYXRlKCk7XG5cbiAgZ2V0IHZhbHVlKCk6IERhdGUge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIEBJbnB1dCgpIHNldCB2YWx1ZShkYXRlOiBEYXRlKSB7XG4gICAgdGhpcy53cml0ZVZhbHVlKGRhdGUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFNwZWNpZmllcyBob3cgYSBkYXkgY2VsbCBzaG91bGQgZ3Jvdy5cbiAgICovXG4gIHByaXZhdGUgX2dyb3c6IEdyb3dNb2RlID0geyBtb2RlOiAnc3RyZXRjaCcgfTtcblxuICBASW5wdXQoKSBzZXQgZ3JvdyAobW9kZTogR3Jvd01vZGUpIHtcbiAgICBpZiAobW9kZSkge1xuICAgICAgdGhpcy5fZ3JvdyA9IG1vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2dyb3cgPSB7IG1vZGU6ICdzdHJldGNoJyB9O1xuICAgIH1cbiAgfVxuXG4gIGdldCBncm93KCk6IEdyb3dNb2RlIHtcbiAgICByZXR1cm4gdGhpcy5fZ3JvdztcbiAgfVxuXG4gIHByaXZhdGUgZGVmYXVsdEZpcnN0RGF5T2ZXZWVrID0gRGF5T2ZXZWVrLlN1bmRheTtcblxuICBwcml2YXRlIGRlZmF1bHREYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyID0gZGVmYXVsdERheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXJGYWN0b3J5KHRoaXMuZGVmYXVsdEZpcnN0RGF5T2ZXZWVrKTtcblxuICAvKipcbiAgICogRmlyc3QgZGF5IG9mIHRoZSB3ZWVrLlxuICAgKi9cbiAgcHJpdmF0ZSBfZmlyc3REYXlPZldlZWs6IERheU9mV2VlayA9IHRoaXMuZGVmYXVsdEZpcnN0RGF5T2ZXZWVrO1xuXG4gIEBJbnB1dCgpIHNldCBmaXJzdERheU9mV2VlayAoZGF5T2ZXZWVrOiBEYXlPZldlZWspIHtcbiAgICB0aGlzLl9maXJzdERheU9mV2VlayA9IGRheU9mV2VlaztcbiAgICB0aGlzLmRlZmF1bHREYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyID0gZGVmYXVsdERheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXJGYWN0b3J5KHRoaXMuX2ZpcnN0RGF5T2ZXZWVrKTtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIGdldCBmaXJzdERheU9mV2VlaygpOiBEYXlPZldlZWsge1xuICAgIHJldHVybiB0aGlzLl9maXJzdERheU9mV2VlaztcbiAgfVxuXG4gIC8qKlxuICAgKiBGb3JtYXR0ZXIgZm9yIGRheXMuXG4gICAqL1xuICBwcml2YXRlIF9kYXlGb3JtYXR0ZXI6IChkYXk/OiBEYXlJbmZvKSA9PiBzdHJpbmc7XG5cbiAgQElucHV0KCkgc2V0IGRheUZvcm1hdHRlciAoZm9ybWF0dGVyOiAoZGF5PzogRGF5SW5mbykgPT4gc3RyaW5nKSB7XG4gICAgdGhpcy5fZGF5Rm9ybWF0dGVyID0gZm9ybWF0dGVyO1xuICAgIHRoaXMucmVmcmVzaCgpO1xuICB9XG5cbiAgZ2V0IGRheUZvcm1hdHRlcigpOiAoZGF5PzogRGF5SW5mbykgPT4gc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fZGF5Rm9ybWF0dGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIENhcHRpb25zIG9mIHRoZSBkaWZmZXJlbnQgZGF5cyBvZiB0aGUgd2Vlay5cbiAgICovXG4gIGRheXNPZldlZWtDYXB0aW9ucztcblxuICAvKipcbiAgICogRm9ybWF0dGVyIGZvciB0aGUgY2FwdGlvbnMgb2YgdGhlIGRpZmZlcmVudFxuICAgKiBkYXlzIG9mIHRoZSB3ZWVrLlxuICAgKi9cbiAgcHJpdmF0ZSBfZGF5T2ZXZWVrQ2FwdGlvbkZvcm1hdHRlcjogKGRheU9mV2VlazogRGF5T2ZXZWVrKSA9PiBzdHJpbmc7XG5cbiAgQElucHV0KCkgc2V0IGRheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXIgKGZvcm1hdHRlcjogKGRheU9mV2VlazogRGF5T2ZXZWVrKSA9PiBzdHJpbmcpIHtcbiAgICB0aGlzLl9kYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyID0gZm9ybWF0dGVyO1xuICAgIHRoaXMucmVmcmVzaCgpO1xuICB9XG5cbiAgZ2V0IGRheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXIoKTogKGRheU9mV2VlazogRGF5T2ZXZWVrKSA9PiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9kYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyO1xuICB9XG5cbiAgLyoqXG4gICAqIENhcHRpb24gb2YgdGhlIG1vbnRoLlxuICAgKi9cbiAgbW9udGhDYXB0aW9uO1xuXG4gIC8qKlxuICAgKiBGb3JtYXR0ZXIgZm9yIHRoZSBtb250aCBjYXB0aW9uLlxuICAgKi9cbiAgcHJpdmF0ZSBfbW9udGhDYXB0aW9uRm9ybWF0dGVyOiAoZGF0ZTogRGF0ZSkgPT4gc3RyaW5nO1xuXG4gIEBJbnB1dCgpIHNldCBtb250aENhcHRpb25Gb3JtYXR0ZXIgKGZvcm1hdHRlcjogKGRhdGU6IERhdGUpID0+IHN0cmluZykge1xuICAgIHRoaXMuX21vbnRoQ2FwdGlvbkZvcm1hdHRlciA9IGZvcm1hdHRlcjtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIGdldCBtb250aENhcHRpb25Gb3JtYXR0ZXIoKTogKGRhdGU6IERhdGUpID0+IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX21vbnRoQ2FwdGlvbkZvcm1hdHRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXRyaWV2ZXMgYSBDU1MgY2xhc3MgZm9yIHRoZSBzcGVjaWZpZWQgZGF5LlxuICAgKi9cbiAgQElucHV0KCkgY3VzdG9tRGF5Q2xhc3M6IChkYXk6IERheUluZm8pID0+IHN0cmluZztcblxuICAvKipcbiAgICogQ1NTIGNsYXNzIGZvciB0aGUgbW9udGguXG4gICAqL1xuICBASW5wdXQoKSBtb250aENsYXNzID0gJ3NjLW1vbnRoJztcblxuICAvKipcbiAgICogQ1NTIGNsYXNzIGZvciB0aGUgZGlzYWJsZWQgc3RhdGUuXG4gICAqL1xuICBASW5wdXQoKSBkaXNhYmxlZENsYXNzID0gJ3NjLW1vbnRoLS1kaXNhYmxlZCc7XG5cbiAgLyoqXG4gICAqIENTUyBjbGFzcyBmb3IgdGhlIG1vbnRoIGNhcHRpb24uXG4gICAqL1xuICBASW5wdXQoKSBtb250aENhcHRpb25DbGFzcyA9ICdzYy1tb250aF9fY2FwdGlvbic7XG5cbiAgLyoqXG4gICAqIENTUyBjbGFzcyBmb3IgdGhlIGRheSBvZiB0aGUgd2VlayBjYXB0aW9ucy5cbiAgICovXG4gIEBJbnB1dCgpIGRheU9mV2Vla0NhcHRpb25DbGFzcyA9ICdzYy1tb250aF9fd2Vlay1jYXB0aW9uJztcblxuICAvKipcbiAgICogQ1NTIGNsYXNzIGZvciB0aGUgZGF5IGNhcHRpb25zLlxuICAgKi9cbiAgQElucHV0KCkgZGF5Q2FwdGlvbkNsYXNzID0gJ3NjLW1vbnRoX19kYXknO1xuXG4gIC8qKlxuICAgKiBDU1MgY2xhc3MgZm9yIHRoZSBjdXJyZW50IGRheS5cbiAgICovXG4gIEBJbnB1dCgpIGN1cnJlbnREYXlDbGFzcyA9ICdzYy1tb250aF9fZGF5LS10b2RheSc7XG5cbiAgLyoqXG4gICAqIENTUyBjbGFzcyBmb3IgdGhlIGRheSB3aGVuIHRoZSBzdGF0ZSBpcyBkaXNhYmxlZC5cbiAgICovXG4gIEBJbnB1dCgpIGRpc2FibGVkRGF5Q2xhc3MgPSAnc2MtbW9udGhfX2RheS0tZGlzYWJsZWQnO1xuXG4gIC8qKlxuICAgKiBDU1MgY2xhc3MgZm9yIHRoZSBzZWxlY3RlZCBkYXkuXG4gICAqL1xuICBASW5wdXQoKSBzZWxlY3RlZERheUNsYXNzID0gJ3NjLW1vbnRoX19kYXktLXNlbGVjdGVkJztcblxuICAvKipcbiAgICogVmlldyBvZiB0aGUgY3VycmVudCBtb250aC5cbiAgICovXG4gIHZpZXc7XG5cbiAgcHJpdmF0ZSBkZWZhdWx0TW9udGhDYXB0aW9uRm9ybWF0dGVyID0gKGRhdGU6IERhdGUpID0+IGRhdGUudG9EYXRlU3RyaW5nKCk7XG4gIHByaXZhdGUgZGVmYXVsdERheUZvcm1hdHRlciA9IChkYXk/OiBEYXlJbmZvKSA9PiBkYXkgPyBkYXkuZGF5LnRvU3RyaW5nKCkgOiAnJztcbiAgcHJpdmF0ZSBvbkNoYW5nZSA9IChkYXRlOiBEYXRlKSA9PiB7IH07XG4gIHByaXZhdGUgb25Ub3VjaGVkID0gKCkgPT4geyB9O1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgY29tcG9uZW50LlxuICAgKi9cbiAgbmdPbkluaXQoKSB7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gIH1cblxuICB3cml0ZVZhbHVlKGRhdGU6IERhdGUpOiB2b2lkIHtcbiAgICBpZiAoZGF0ZSkge1xuICAgICAgdGhpcy5fdmFsdWUgPSBkYXRlO1xuICAgICAgdGhpcy5yZWZyZXNoKCk7XG4gICAgICB0aGlzLm9uQ2hhbmdlKGRhdGUpO1xuICAgIH1cbiAgfVxuXG4gIHJlZ2lzdGVyT25DaGFuZ2UoZm46IChkYXRlOiBEYXRlKSA9PiB7fSk6IHZvaWQge1xuICAgIHRoaXMub25DaGFuZ2UgPSBmbjtcbiAgfVxuXG4gIHJlZ2lzdGVyT25Ub3VjaGVkKGZuOiAoKSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy5vblRvdWNoZWQgPSBmbjtcbiAgfVxuXG4gIHNldERpc2FibGVkU3RhdGUoaXNEaXNhYmxlZDogYm9vbGVhbik6IHZvaWQge1xuICAgIHRoaXMuZGlzYWJsZWQgPSBpc0Rpc2FibGVkO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZnJlc2hlcyB0aGUgY29tcG9uZW50LlxuICAgKi9cbiAgcHJpdmF0ZSByZWZyZXNoKCk6IHZvaWQge1xuICAgIHRoaXMucmVmcmVzaE1vbnRoQ2FwdGlvbih0aGlzLnZhbHVlKTtcbiAgICB0aGlzLnJlZnJlc2hEYXlPZldlZWtDYXB0aW9ucygpO1xuICAgIHRoaXMucmVmcmVzaFZpZXcodGhpcy52YWx1ZSk7XG4gIH1cblxuICAvKipcbiAgICogUmVmcmVzaGVzIHRoZSBtb250aCBjYXB0aW9uLlxuICAgKiBAcGFyYW0gZGF0ZSBEYXRlLlxuICAgKi9cbiAgcHJpdmF0ZSByZWZyZXNoTW9udGhDYXB0aW9uKGRhdGU6IERhdGUpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5tb250aENhcHRpb25Gb3JtYXR0ZXIpIHtcbiAgICAgIHRoaXMubW9udGhDYXB0aW9uID0gdGhpcy5tb250aENhcHRpb25Gb3JtYXR0ZXIoZGF0ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMubW9udGhDYXB0aW9uID0gdGhpcy5kZWZhdWx0TW9udGhDYXB0aW9uRm9ybWF0dGVyKGRhdGUpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBSZWZyZXNoZXMgdGhlIGRheSBvZiB3ZWVrIGNhcHRpb25zLlxuICAgKi9cbiAgcHJpdmF0ZSByZWZyZXNoRGF5T2ZXZWVrQ2FwdGlvbnMoKTogdm9pZCB7XG4gICAgY29uc3QgZGF5Q2FwdGlvbnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBjb25zdCBkYXlPZldlZWtGb3JtYXR0ZXIgPSB0aGlzLmRheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXIgP1xuICAgICAgdGhpcy5kYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyIDpcbiAgICAgIHRoaXMuZGVmYXVsdERheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXI7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IERBWV9OQU1FUy5sZW5ndGg7IGkrKykge1xuICAgICAgZGF5Q2FwdGlvbnMucHVzaChkYXlPZldlZWtGb3JtYXR0ZXIoaSkpO1xuICAgIH1cblxuICAgIHRoaXMuZGF5c09mV2Vla0NhcHRpb25zID0gZGF5Q2FwdGlvbnM7XG4gIH1cblxuICAvKipcbiAgICogUmVmcmVzaGVzIHRoZSBjYWxlbmRhciB2aWV3LlxuICAgKiBAcGFyYW0gZGF0ZSBEYXRlLlxuICAgKi9cbiAgcHJpdmF0ZSByZWZyZXNoVmlldyhkYXRlOiBEYXRlKTogdm9pZCB7XG4gICAgdGhpcy52aWV3ID0gbmV3IE1vbnRoVmlldyhkYXRlKS5jcmVhdGVWaWV3KGZhbHNlLCB0aGlzLmZpcnN0RGF5T2ZXZWVrKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBDU1MgY2xhc3NlcyB0byBhcHBseSB0byB0aGUgbW9udGguXG4gICAqL1xuICBnZXRDbGFzc0Zvck1vbnRoKCk6IHN0cmluZyB7XG4gICAgbGV0IGNsYXNzZXNUb0FwcGx5ID0gdGhpcy5tb250aENsYXNzO1xuXG4gICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIGNsYXNzZXNUb0FwcGx5ID0gdGhpcy5tb250aENsYXNzICsgJyAnICsgdGhpcy5kaXNhYmxlZENsYXNzO1xuICAgIH1cblxuICAgIHJldHVybiBjbGFzc2VzVG9BcHBseTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIHRoZSBDU1MgY2xhc3MgYXBwbGljYWJsZSB0b1xuICAgKiB0aGUgc3BlY2lmaWVkIGRheS5cbiAgICogQHBhcmFtIGRheSBEYXkuXG4gICAqL1xuICBnZXRDbGFzc0ZvckRheShkYXk/OiBEYXlJbmZvKTogc3RyaW5nIHtcbiAgICBsZXQgZGF5Q2xhc3NUb0FwcGx5ID0gJyc7XG5cbiAgICBpZiAoZGF5KSB7XG5cbiAgICAgIGlmIChkYXkuZGF5ID09PSB0aGlzLnZhbHVlLmdldERhdGUoKSkge1xuICAgICAgICBkYXlDbGFzc1RvQXBwbHkgPSB0aGlzLnNlbGVjdGVkRGF5Q2xhc3M7XG4gICAgICB9IGVsc2UgaWYgKGRheS5pc1RvZGF5KSB7XG4gICAgICAgIGRheUNsYXNzVG9BcHBseSA9IHRoaXMuY3VycmVudERheUNsYXNzO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmN1c3RvbURheUNsYXNzKSB7XG4gICAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSh0aGlzLnZhbHVlLnZhbHVlT2YoKSk7XG4gICAgICAgIGRhdGUuc2V0RGF0ZShkYXkuZGF5KTtcbiAgICAgICAgZGF5Q2xhc3NUb0FwcGx5ID0gdGhpcy5jdXN0b21EYXlDbGFzcyhkYXkpO1xuICAgICAgfVxuXG4gICAgICBpZiAodGhpcy5kaXNhYmxlZCkge1xuICAgICAgICBkYXlDbGFzc1RvQXBwbHkgPSBkYXlDbGFzc1RvQXBwbHkgKyAnICcgKyB0aGlzLmRpc2FibGVkRGF5Q2xhc3M7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB0aGlzLmRheUNhcHRpb25DbGFzcyArICcgJyArIGRheUNsYXNzVG9BcHBseTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuZGF5Q2FwdGlvbkNsYXNzO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGEgZm9ybWF0dGVkIHN0cmluZyBjb3JyZXNwb25kaW5nXG4gICAqIHRvIHRoZSBzcGVjaWZpZWQgZGF5LlxuICAgKiBAcGFyYW0gZGF5IERheSB0byBmb3JtYXQuXG4gICAqL1xuICBnZXRGb3JtYXR0ZWREYXkoZGF5OiBEYXlJbmZvKTogc3RyaW5nIHtcbiAgICBpZiAodGhpcy5kYXlGb3JtYXR0ZXIpIHtcbiAgICAgIHJldHVybiB0aGlzLmRheUZvcm1hdHRlcihkYXkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5kZWZhdWx0RGF5Rm9ybWF0dGVyKGRheSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnRyb2xzIHRoZSBjbGljayBldmVudCBvZiBhIGRheSBjZWxsLlxuICAgKiBAcGFyYW0gZGF5SW5mbyBJbmZvIGFib3V0IHRoZSBzZWxlY3RlZCBkYXkuXG4gICAqL1xuICBvbkRheUNsaWNrKGRheUluZm86IERheUluZm8pOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlzYWJsZWQgJiYgZGF5SW5mbykge1xuICAgICAgY29uc3Qgc2VsZWN0ZWREYXRlID0gbmV3IERhdGUodGhpcy52YWx1ZS52YWx1ZU9mKCkpO1xuICAgICAgc2VsZWN0ZWREYXRlLnNldERhdGUoZGF5SW5mby5kYXkpO1xuXG4gICAgICB0aGlzLnZhbHVlID0gbmV3IERhdGUoc2VsZWN0ZWREYXRlLnZhbHVlT2YoKSk7XG5cbiAgICAgIHRoaXMuY2hhbmdlLmVtaXQoc2VsZWN0ZWREYXRlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQ29udHJvbHMgdGhlIGNsaWNrIGV2ZW50IG9mIHRoZSBtb250aC5cbiAgICovXG4gIG9uTW9udGhDbGljaygpOiB2b2lkIHtcbiAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHtcbiAgICAgIHRoaXMubW9udGhDbGljay5lbWl0KHRoaXMpO1xuICAgIH1cbiAgfVxufVxuIl19