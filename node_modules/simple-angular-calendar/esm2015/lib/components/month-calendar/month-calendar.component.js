/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, EventEmitter, forwardRef, Input, Output, ContentChild, TemplateRef } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
import { DAY_NAMES } from '../../models/day-names';
import { MonthView } from '../../models/views/moth-view';
import { DayTemplateDirective } from '../../directives/day-template.directive';
import { DayOfWeekCaptionTemplateDirective } from '../../directives/day-of-week-caption-template.directive';
import { MonthCaptionTemplateDirective } from '../../directives/month-caption-template.directive';
import { DayOfWeek } from '../../models/day-of-week';
import { defaultDayOfWeekCaptionFormatterFactory } from '../../models/formatters/day-of-week-caption-formatter';
/** *
 * Month calendar provider.
  @type {?} */
export const MONTH_CALENDAR_VALUE_ACCESSOR = {
    provide: NG_VALUE_ACCESSOR,
    useExisting: forwardRef(() => MonthCalendarComponent),
    multi: true
};
/**
 * Control that represents a calendar.
 */
export class MonthCalendarComponent {
    constructor() {
        /**
         * Event raised when the user selects a date.
         */
        this.change = new EventEmitter();
        /**
         * Event raised when the user clicks the calendar.
         */
        this.monthClick = new EventEmitter();
        /**
         * Sets if the control should be in a
         * disabled state.
         */
        this.disabled = false;
        /**
         * Date to show.
         */
        this._value = new Date();
        /**
         * Specifies how a day cell should grow.
         */
        this._grow = { mode: 'stretch' };
        this.defaultFirstDayOfWeek = DayOfWeek.Sunday;
        this.defaultDayOfWeekCaptionFormatter = defaultDayOfWeekCaptionFormatterFactory(this.defaultFirstDayOfWeek);
        /**
         * First day of the week.
         */
        this._firstDayOfWeek = this.defaultFirstDayOfWeek;
        /**
         * CSS class for the month.
         */
        this.monthClass = 'sc-month';
        /**
         * CSS class for the disabled state.
         */
        this.disabledClass = 'sc-month--disabled';
        /**
         * CSS class for the month caption.
         */
        this.monthCaptionClass = 'sc-month__caption';
        /**
         * CSS class for the day of the week captions.
         */
        this.dayOfWeekCaptionClass = 'sc-month__week-caption';
        /**
         * CSS class for the day captions.
         */
        this.dayCaptionClass = 'sc-month__day';
        /**
         * CSS class for the current day.
         */
        this.currentDayClass = 'sc-month__day--today';
        /**
         * CSS class for the day when the state is disabled.
         */
        this.disabledDayClass = 'sc-month__day--disabled';
        /**
         * CSS class for the selected day.
         */
        this.selectedDayClass = 'sc-month__day--selected';
        this.defaultMonthCaptionFormatter = (date) => date.toDateString();
        this.defaultDayFormatter = (day) => day ? day.day.toString() : '';
        this.onChange = (date) => { };
        this.onTouched = () => { };
    }
    /**
     * @return {?}
     */
    get value() {
        return this._value;
    }
    /**
     * @param {?} date
     * @return {?}
     */
    set value(date) {
        this.writeValue(date);
    }
    /**
     * @param {?} mode
     * @return {?}
     */
    set grow(mode) {
        if (mode) {
            this._grow = mode;
        }
        else {
            this._grow = { mode: 'stretch' };
        }
    }
    /**
     * @return {?}
     */
    get grow() {
        return this._grow;
    }
    /**
     * @param {?} dayOfWeek
     * @return {?}
     */
    set firstDayOfWeek(dayOfWeek) {
        this._firstDayOfWeek = dayOfWeek;
        this.defaultDayOfWeekCaptionFormatter = defaultDayOfWeekCaptionFormatterFactory(this._firstDayOfWeek);
        this.refresh();
    }
    /**
     * @return {?}
     */
    get firstDayOfWeek() {
        return this._firstDayOfWeek;
    }
    /**
     * @param {?} formatter
     * @return {?}
     */
    set dayFormatter(formatter) {
        this._dayFormatter = formatter;
        this.refresh();
    }
    /**
     * @return {?}
     */
    get dayFormatter() {
        return this._dayFormatter;
    }
    /**
     * @param {?} formatter
     * @return {?}
     */
    set dayOfWeekCaptionFormatter(formatter) {
        this._dayOfWeekCaptionFormatter = formatter;
        this.refresh();
    }
    /**
     * @return {?}
     */
    get dayOfWeekCaptionFormatter() {
        return this._dayOfWeekCaptionFormatter;
    }
    /**
     * @param {?} formatter
     * @return {?}
     */
    set monthCaptionFormatter(formatter) {
        this._monthCaptionFormatter = formatter;
        this.refresh();
    }
    /**
     * @return {?}
     */
    get monthCaptionFormatter() {
        return this._monthCaptionFormatter;
    }
    /**
     * Initializes the component.
     * @return {?}
     */
    ngOnInit() {
        this.refresh();
    }
    /**
     * @param {?} date
     * @return {?}
     */
    writeValue(date) {
        if (date) {
            this._value = date;
            this.refresh();
            this.onChange(date);
        }
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnChange(fn) {
        this.onChange = fn;
    }
    /**
     * @param {?} fn
     * @return {?}
     */
    registerOnTouched(fn) {
        this.onTouched = fn;
    }
    /**
     * @param {?} isDisabled
     * @return {?}
     */
    setDisabledState(isDisabled) {
        this.disabled = isDisabled;
    }
    /**
     * Refreshes the component.
     * @return {?}
     */
    refresh() {
        this.refreshMonthCaption(this.value);
        this.refreshDayOfWeekCaptions();
        this.refreshView(this.value);
    }
    /**
     * Refreshes the month caption.
     * @param {?} date Date.
     * @return {?}
     */
    refreshMonthCaption(date) {
        if (this.monthCaptionFormatter) {
            this.monthCaption = this.monthCaptionFormatter(date);
        }
        else {
            this.monthCaption = this.defaultMonthCaptionFormatter(date);
        }
    }
    /**
     * Refreshes the day of week captions.
     * @return {?}
     */
    refreshDayOfWeekCaptions() {
        /** @type {?} */
        const dayCaptions = [];
        /** @type {?} */
        const dayOfWeekFormatter = this.dayOfWeekCaptionFormatter ?
            this.dayOfWeekCaptionFormatter :
            this.defaultDayOfWeekCaptionFormatter;
        for (let i = 0; i < DAY_NAMES.length; i++) {
            dayCaptions.push(dayOfWeekFormatter(i));
        }
        this.daysOfWeekCaptions = dayCaptions;
    }
    /**
     * Refreshes the calendar view.
     * @param {?} date Date.
     * @return {?}
     */
    refreshView(date) {
        this.view = new MonthView(date).createView(false, this.firstDayOfWeek);
    }
    /**
     * Gets the CSS classes to apply to the month.
     * @return {?}
     */
    getClassForMonth() {
        /** @type {?} */
        let classesToApply = this.monthClass;
        if (this.disabled) {
            classesToApply = this.monthClass + ' ' + this.disabledClass;
        }
        return classesToApply;
    }
    /**
     * Gets the CSS class applicable to
     * the specified day.
     * @param {?=} day Day.
     * @return {?}
     */
    getClassForDay(day) {
        /** @type {?} */
        let dayClassToApply = '';
        if (day) {
            if (day.day === this.value.getDate()) {
                dayClassToApply = this.selectedDayClass;
            }
            else if (day.isToday) {
                dayClassToApply = this.currentDayClass;
            }
            else if (this.customDayClass) {
                /** @type {?} */
                const date = new Date(this.value.valueOf());
                date.setDate(day.day);
                dayClassToApply = this.customDayClass(day);
            }
            if (this.disabled) {
                dayClassToApply = dayClassToApply + ' ' + this.disabledDayClass;
            }
            return this.dayCaptionClass + ' ' + dayClassToApply;
        }
        else {
            return this.dayCaptionClass;
        }
    }
    /**
     * Gets a formatted string corresponding
     * to the specified day.
     * @param {?} day Day to format.
     * @return {?}
     */
    getFormattedDay(day) {
        if (this.dayFormatter) {
            return this.dayFormatter(day);
        }
        else {
            return this.defaultDayFormatter(day);
        }
    }
    /**
     * Controls the click event of a day cell.
     * @param {?} dayInfo Info about the selected day.
     * @return {?}
     */
    onDayClick(dayInfo) {
        if (!this.disabled && dayInfo) {
            /** @type {?} */
            const selectedDate = new Date(this.value.valueOf());
            selectedDate.setDate(dayInfo.day);
            this.value = new Date(selectedDate.valueOf());
            this.change.emit(selectedDate);
        }
    }
    /**
     * Controls the click event of the month.
     * @return {?}
     */
    onMonthClick() {
        if (!this.disabled) {
            this.monthClick.emit(this);
        }
    }
}
MonthCalendarComponent.decorators = [
    { type: Component, args: [{
                selector: 'sc-month-calendar',
                template: `<!-- Month -->
<div (click)="onMonthClick()"
     [ngClass]="['column', grow.mode == 'stretch' ? 'stretch-vertically' : '', getClassForMonth()]">

  <!-- Month caption -->
  <div class="row">

    <!-- Month caption cell -->
    <div class="w-100"
         [class.label]="grow.mode != 'mixed'"
         [class.ratio-height]="grow.mode == 'proportional'"
         [class.stretch-horizontally]="grow.mode == 'stretch' || grow.mode == 'mixed'">

      <!-- Month caption cell content -->
      <div [class.label__content]="grow.mode != 'mixed'">

        <ng-container *ngTemplateOutlet="monthTemplate ? monthTemplate : defaultMonthTemplate; context: { $implicit: value }"></ng-container>

      </div>
    </div>
  </div>

  <!-- Week captions -->
  <div class="row">

    <!-- Week captions cell -->
    <div [class.label]="grow.mode != 'mixed'"
         [class.ratio-square]="grow.mode == 'proportional'"
         [class.stretch-horizontally]="grow.mode == 'stretch' || grow.mode == 'mixed'"
         *ngFor="let dayOfWeekCaption of daysOfWeekCaptions; let i = index">

      <!-- Week caption cell content -->
      <div [class.label__content]="grow.mode != 'mixed'">

        <ng-container *ngTemplateOutlet="dayOfWeekTemplate ? dayOfWeekTemplate : defaultDayOfWeekTemplate; context: { $implicit: dayOfWeekCaption, dayOfWeekIndex: i }"></ng-container>

      </div>
    </div>
  </div>

  <!-- Days -->
  <div class="row"
       *ngFor="let week of view">

    <!-- Day cell -->
    <div (click)="onDayClick(day)"
         class="ratio-square label"
         [class.ratio-square]="grow.mode == 'proportional' || grow.mode == 'mixed'"
         [class.stretch-horizontally]="grow.mode == 'stretch'"
         *ngFor="let day of week">

      <!-- Day content -->
      <div class="label__content">

        <ng-container *ngTemplateOutlet="dayTemplate ? dayTemplate : defaultDayTemplate; context: { $implicit: day }"></ng-container>

      </div>

    </div>

  </div>

</div>



<!-- Templates -->

<!-- Day template -->
<ng-template #defaultDayTemplate
             let-day>
  <div class="flex-expanded-container">
    <div [ngClass]="['flex-expand', getClassForDay(day)]">{{ getFormattedDay(day) }}</div>
  </div>
</ng-template>

<!-- Day of week cells template -->
<ng-template #defaultDayOfWeekTemplate
             let-dayOfWeek
             let-dayOfWeekIndex="dayOfWeekIndex">
  <div [class.flex-expanded-container]="grow.mode != 'mixed'">
    <div [ngClass]="['flex-expand', 'flex-centered', dayOfWeekCaptionClass]">
      {{ dayOfWeek }}
    </div>
  </div>
</ng-template>

<!-- Month cell template -->
<ng-template #defaultMonthTemplate
             let-date>
  <div [class.flex-expanded-container]="grow.mode != 'mixed'">
    <div [ngClass]="['flex-expand', 'flex-centered', monthCaptionClass]">
      {{ monthCaption }}
    </div>
  </div>
</ng-template>
`,
                styles: [`.column{display:flex;flex-flow:column;flex:1}.row{display:flex;flex:1}.label{position:relative}.label__content{position:absolute;top:0;left:0;bottom:0;right:0}.flex-expanded-container{display:flex;position:absolute;width:100%;height:100%}.flex-expand{flex:1}.flex-centered{display:flex;align-items:center;justify-content:center}.ratio-height{padding-bottom:14.28571%}.ratio-square{padding-bottom:14.28571%;width:14.28571%}.stretch-vertically{height:100%}.stretch-horizontally{width:14.28571%}.fixed-height{display:flex;flex:1}.w-100{width:100%}.sc-month{font-size:2rem}.sc-month--disabled{opacity:.25}.sc-month__caption,.sc-month__week-caption{border:1px solid #000;font-weight:700}.sc-month__day{border:1px solid #000;cursor:pointer}.sc-month__day--disabled{cursor:auto}.sc-month__day--today{background:pink}.sc-month__day--selected{background:#6495ed}`],
                providers: [MONTH_CALENDAR_VALUE_ACCESSOR]
            },] },
];
MonthCalendarComponent.propDecorators = {
    dayTemplate: [{ type: ContentChild, args: [DayTemplateDirective, { read: TemplateRef },] }],
    dayOfWeekTemplate: [{ type: ContentChild, args: [DayOfWeekCaptionTemplateDirective, { read: TemplateRef },] }],
    monthTemplate: [{ type: ContentChild, args: [MonthCaptionTemplateDirective, { read: TemplateRef },] }],
    change: [{ type: Output, args: ['change',] }],
    monthClick: [{ type: Output, args: ['monthClick',] }],
    disabled: [{ type: Input }],
    value: [{ type: Input }],
    grow: [{ type: Input }],
    firstDayOfWeek: [{ type: Input }],
    dayFormatter: [{ type: Input }],
    dayOfWeekCaptionFormatter: [{ type: Input }],
    monthCaptionFormatter: [{ type: Input }],
    customDayClass: [{ type: Input }],
    monthClass: [{ type: Input }],
    disabledClass: [{ type: Input }],
    monthCaptionClass: [{ type: Input }],
    dayOfWeekCaptionClass: [{ type: Input }],
    dayCaptionClass: [{ type: Input }],
    currentDayClass: [{ type: Input }],
    disabledDayClass: [{ type: Input }],
    selectedDayClass: [{ type: Input }]
};
if (false) {
    /** @type {?} */
    MonthCalendarComponent.prototype.dayTemplate;
    /** @type {?} */
    MonthCalendarComponent.prototype.dayOfWeekTemplate;
    /** @type {?} */
    MonthCalendarComponent.prototype.monthTemplate;
    /**
     * Event raised when the user selects a date.
     * @type {?}
     */
    MonthCalendarComponent.prototype.change;
    /**
     * Event raised when the user clicks the calendar.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthClick;
    /**
     * Sets if the control should be in a
     * disabled state.
     * @type {?}
     */
    MonthCalendarComponent.prototype.disabled;
    /**
     * Date to show.
     * @type {?}
     */
    MonthCalendarComponent.prototype._value;
    /**
     * Specifies how a day cell should grow.
     * @type {?}
     */
    MonthCalendarComponent.prototype._grow;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultFirstDayOfWeek;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultDayOfWeekCaptionFormatter;
    /**
     * First day of the week.
     * @type {?}
     */
    MonthCalendarComponent.prototype._firstDayOfWeek;
    /**
     * Formatter for days.
     * @type {?}
     */
    MonthCalendarComponent.prototype._dayFormatter;
    /**
     * Captions of the different days of the week.
     * @type {?}
     */
    MonthCalendarComponent.prototype.daysOfWeekCaptions;
    /**
     * Formatter for the captions of the different
     * days of the week.
     * @type {?}
     */
    MonthCalendarComponent.prototype._dayOfWeekCaptionFormatter;
    /**
     * Caption of the month.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthCaption;
    /**
     * Formatter for the month caption.
     * @type {?}
     */
    MonthCalendarComponent.prototype._monthCaptionFormatter;
    /**
     * Retrieves a CSS class for the specified day.
     * @type {?}
     */
    MonthCalendarComponent.prototype.customDayClass;
    /**
     * CSS class for the month.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthClass;
    /**
     * CSS class for the disabled state.
     * @type {?}
     */
    MonthCalendarComponent.prototype.disabledClass;
    /**
     * CSS class for the month caption.
     * @type {?}
     */
    MonthCalendarComponent.prototype.monthCaptionClass;
    /**
     * CSS class for the day of the week captions.
     * @type {?}
     */
    MonthCalendarComponent.prototype.dayOfWeekCaptionClass;
    /**
     * CSS class for the day captions.
     * @type {?}
     */
    MonthCalendarComponent.prototype.dayCaptionClass;
    /**
     * CSS class for the current day.
     * @type {?}
     */
    MonthCalendarComponent.prototype.currentDayClass;
    /**
     * CSS class for the day when the state is disabled.
     * @type {?}
     */
    MonthCalendarComponent.prototype.disabledDayClass;
    /**
     * CSS class for the selected day.
     * @type {?}
     */
    MonthCalendarComponent.prototype.selectedDayClass;
    /**
     * View of the current month.
     * @type {?}
     */
    MonthCalendarComponent.prototype.view;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultMonthCaptionFormatter;
    /** @type {?} */
    MonthCalendarComponent.prototype.defaultDayFormatter;
    /** @type {?} */
    MonthCalendarComponent.prototype.onChange;
    /** @type {?} */
    MonthCalendarComponent.prototype.onTouched;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9udGgtY2FsZW5kYXIuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vc2ltcGxlLWFuZ3VsYXItY2FsZW5kYXIvIiwic291cmNlcyI6WyJsaWIvY29tcG9uZW50cy9tb250aC1jYWxlbmRhci9tb250aC1jYWxlbmRhci5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFVBQVUsRUFBZSxLQUFLLEVBQUUsTUFBTSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQVUsTUFBTSxlQUFlLENBQUM7QUFDbkksT0FBTyxFQUF3QixpQkFBaUIsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRXpFLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUNuRCxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sOEJBQThCLENBQUM7QUFDekQsT0FBTyxFQUFFLG9CQUFvQixFQUFFLE1BQU0seUNBQXlDLENBQUM7QUFDL0UsT0FBTyxFQUFFLGlDQUFpQyxFQUFFLE1BQU0seURBQXlELENBQUM7QUFDNUcsT0FBTyxFQUFFLDZCQUE2QixFQUFFLE1BQU0sbURBQW1ELENBQUM7QUFDbEcsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLDBCQUEwQixDQUFDO0FBQ3JELE9BQU8sRUFBRSx1Q0FBdUMsRUFBRSxNQUFNLHVEQUF1RCxDQUFDOzs7O0FBTWhILGFBQWEsNkJBQTZCLEdBQVE7SUFDaEQsT0FBTyxFQUFFLGlCQUFpQjtJQUMxQixXQUFXLEVBQUUsVUFBVSxDQUFDLEdBQUcsRUFBRSxDQUFDLHNCQUFzQixDQUFDO0lBQ3JELEtBQUssRUFBRSxJQUFJO0NBQ1osQ0FBQzs7OztBQTJHRixNQUFNOzs7OztzQkFRdUIsSUFBSSxZQUFZLEVBQVE7Ozs7MEJBS2hCLElBQUksWUFBWSxFQUEwQjs7Ozs7d0JBTXpELEtBQUs7Ozs7c0JBS1IsSUFBSSxJQUFJLEVBQUU7Ozs7cUJBYUQsRUFB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LFlBQVk7UUFDVixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDO1lBQ25CLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1NBQzVCO0tBQ0Y7OztZQS9hRixTQUFTLFNBQUM7Z0JBQ1QsUUFBUSxFQUFFLG1CQUFtQjtnQkFDN0IsUUFBUSxFQUFFOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Q0FnR1g7Z0JBQ0MsTUFBTSxFQUFFLENBQUMsdTFCQUF1MUIsQ0FBQztnQkFDajJCLFNBQVMsRUFBRSxDQUFDLDZCQUE2QixDQUFDO2FBQzNDOzs7MEJBRUUsWUFBWSxTQUFDLG9CQUFvQixFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTtnQ0FDeEQsWUFBWSxTQUFDLGlDQUFpQyxFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTs0QkFDckUsWUFBWSxTQUFDLDZCQUE2QixFQUFFLEVBQUUsSUFBSSxFQUFFLFdBQVcsRUFBRTtxQkFLakUsTUFBTSxTQUFDLFFBQVE7eUJBS2YsTUFBTSxTQUFDLFlBQVk7dUJBTW5CLEtBQUs7b0JBV0wsS0FBSzttQkFTTCxLQUFLOzZCQXFCTCxLQUFLOzJCQWVMLEtBQUs7d0NBb0JMLEtBQUs7b0NBbUJMLEtBQUs7NkJBWUwsS0FBSzt5QkFLTCxLQUFLOzRCQUtMLEtBQUs7Z0NBS0wsS0FBSztvQ0FLTCxLQUFLOzhCQUtMLEtBQUs7OEJBS0wsS0FBSzsrQkFLTCxLQUFLOytCQUtMLEtBQUsiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgZm9yd2FyZFJlZiwgSG9zdEJpbmRpbmcsIElucHV0LCBPdXRwdXQsIENvbnRlbnRDaGlsZCwgVGVtcGxhdGVSZWYsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE5HX1ZBTFVFX0FDQ0VTU09SIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgRGF5SW5mbyB9IGZyb20gJy4uLy4uL21vZGVscy9kYXktaW5mbyc7XG5pbXBvcnQgeyBEQVlfTkFNRVMgfSBmcm9tICcuLi8uLi9tb2RlbHMvZGF5LW5hbWVzJztcbmltcG9ydCB7IE1vbnRoVmlldyB9IGZyb20gJy4uLy4uL21vZGVscy92aWV3cy9tb3RoLXZpZXcnO1xuaW1wb3J0IHsgRGF5VGVtcGxhdGVEaXJlY3RpdmUgfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL2RheS10ZW1wbGF0ZS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgRGF5T2ZXZWVrQ2FwdGlvblRlbXBsYXRlRGlyZWN0aXZlIH0gZnJvbSAnLi4vLi4vZGlyZWN0aXZlcy9kYXktb2Ytd2Vlay1jYXB0aW9uLXRlbXBsYXRlLmRpcmVjdGl2ZSc7XG5pbXBvcnQgeyBNb250aENhcHRpb25UZW1wbGF0ZURpcmVjdGl2ZSB9IGZyb20gJy4uLy4uL2RpcmVjdGl2ZXMvbW9udGgtY2FwdGlvbi10ZW1wbGF0ZS5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgRGF5T2ZXZWVrIH0gZnJvbSAnLi4vLi4vbW9kZWxzL2RheS1vZi13ZWVrJztcbmltcG9ydCB7IGRlZmF1bHREYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyRmFjdG9yeSB9IGZyb20gJy4uLy4uL21vZGVscy9mb3JtYXR0ZXJzL2RheS1vZi13ZWVrLWNhcHRpb24tZm9ybWF0dGVyJztcbmltcG9ydCB7IEdyb3dNb2RlIH0gZnJvbSAnLi4vLi4vbW9kZWxzL2dyb3ctbW9kZSc7XG5cbi8qKlxuICogTW9udGggY2FsZW5kYXIgcHJvdmlkZXIuXG4gKi9cbmV4cG9ydCBjb25zdCBNT05USF9DQUxFTkRBUl9WQUxVRV9BQ0NFU1NPUjogYW55ID0ge1xuICBwcm92aWRlOiBOR19WQUxVRV9BQ0NFU1NPUixcbiAgdXNlRXhpc3Rpbmc6IGZvcndhcmRSZWYoKCkgPT4gTW9udGhDYWxlbmRhckNvbXBvbmVudCksXG4gIG11bHRpOiB0cnVlXG59O1xuXG4vKipcbiAqIENvbnRyb2wgdGhhdCByZXByZXNlbnRzIGEgY2FsZW5kYXIuXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3NjLW1vbnRoLWNhbGVuZGFyJyxcbiAgdGVtcGxhdGU6IGA8IS0tIE1vbnRoIC0tPlxuPGRpdiAoY2xpY2spPVwib25Nb250aENsaWNrKClcIlxuICAgICBbbmdDbGFzc109XCJbJ2NvbHVtbicsIGdyb3cubW9kZSA9PSAnc3RyZXRjaCcgPyAnc3RyZXRjaC12ZXJ0aWNhbGx5JyA6ICcnLCBnZXRDbGFzc0Zvck1vbnRoKCldXCI+XG5cbiAgPCEtLSBNb250aCBjYXB0aW9uIC0tPlxuICA8ZGl2IGNsYXNzPVwicm93XCI+XG5cbiAgICA8IS0tIE1vbnRoIGNhcHRpb24gY2VsbCAtLT5cbiAgICA8ZGl2IGNsYXNzPVwidy0xMDBcIlxuICAgICAgICAgW2NsYXNzLmxhYmVsXT1cImdyb3cubW9kZSAhPSAnbWl4ZWQnXCJcbiAgICAgICAgIFtjbGFzcy5yYXRpby1oZWlnaHRdPVwiZ3Jvdy5tb2RlID09ICdwcm9wb3J0aW9uYWwnXCJcbiAgICAgICAgIFtjbGFzcy5zdHJldGNoLWhvcml6b250YWxseV09XCJncm93Lm1vZGUgPT0gJ3N0cmV0Y2gnIHx8IGdyb3cubW9kZSA9PSAnbWl4ZWQnXCI+XG5cbiAgICAgIDwhLS0gTW9udGggY2FwdGlvbiBjZWxsIGNvbnRlbnQgLS0+XG4gICAgICA8ZGl2IFtjbGFzcy5sYWJlbF9fY29udGVudF09XCJncm93Lm1vZGUgIT0gJ21peGVkJ1wiPlxuXG4gICAgICAgIDxuZy1jb250YWluZXIgKm5nVGVtcGxhdGVPdXRsZXQ9XCJtb250aFRlbXBsYXRlID8gbW9udGhUZW1wbGF0ZSA6IGRlZmF1bHRNb250aFRlbXBsYXRlOyBjb250ZXh0OiB7ICRpbXBsaWNpdDogdmFsdWUgfVwiPjwvbmctY29udGFpbmVyPlxuXG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG5cbiAgPCEtLSBXZWVrIGNhcHRpb25zIC0tPlxuICA8ZGl2IGNsYXNzPVwicm93XCI+XG5cbiAgICA8IS0tIFdlZWsgY2FwdGlvbnMgY2VsbCAtLT5cbiAgICA8ZGl2IFtjbGFzcy5sYWJlbF09XCJncm93Lm1vZGUgIT0gJ21peGVkJ1wiXG4gICAgICAgICBbY2xhc3MucmF0aW8tc3F1YXJlXT1cImdyb3cubW9kZSA9PSAncHJvcG9ydGlvbmFsJ1wiXG4gICAgICAgICBbY2xhc3Muc3RyZXRjaC1ob3Jpem9udGFsbHldPVwiZ3Jvdy5tb2RlID09ICdzdHJldGNoJyB8fCBncm93Lm1vZGUgPT0gJ21peGVkJ1wiXG4gICAgICAgICAqbmdGb3I9XCJsZXQgZGF5T2ZXZWVrQ2FwdGlvbiBvZiBkYXlzT2ZXZWVrQ2FwdGlvbnM7IGxldCBpID0gaW5kZXhcIj5cblxuICAgICAgPCEtLSBXZWVrIGNhcHRpb24gY2VsbCBjb250ZW50IC0tPlxuICAgICAgPGRpdiBbY2xhc3MubGFiZWxfX2NvbnRlbnRdPVwiZ3Jvdy5tb2RlICE9ICdtaXhlZCdcIj5cblxuICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiZGF5T2ZXZWVrVGVtcGxhdGUgPyBkYXlPZldlZWtUZW1wbGF0ZSA6IGRlZmF1bHREYXlPZldlZWtUZW1wbGF0ZTsgY29udGV4dDogeyAkaW1wbGljaXQ6IGRheU9mV2Vla0NhcHRpb24sIGRheU9mV2Vla0luZGV4OiBpIH1cIj48L25nLWNvbnRhaW5lcj5cblxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIDwvZGl2PlxuXG4gIDwhLS0gRGF5cyAtLT5cbiAgPGRpdiBjbGFzcz1cInJvd1wiXG4gICAgICAgKm5nRm9yPVwibGV0IHdlZWsgb2Ygdmlld1wiPlxuXG4gICAgPCEtLSBEYXkgY2VsbCAtLT5cbiAgICA8ZGl2IChjbGljayk9XCJvbkRheUNsaWNrKGRheSlcIlxuICAgICAgICAgY2xhc3M9XCJyYXRpby1zcXVhcmUgbGFiZWxcIlxuICAgICAgICAgW2NsYXNzLnJhdGlvLXNxdWFyZV09XCJncm93Lm1vZGUgPT0gJ3Byb3BvcnRpb25hbCcgfHwgZ3Jvdy5tb2RlID09ICdtaXhlZCdcIlxuICAgICAgICAgW2NsYXNzLnN0cmV0Y2gtaG9yaXpvbnRhbGx5XT1cImdyb3cubW9kZSA9PSAnc3RyZXRjaCdcIlxuICAgICAgICAgKm5nRm9yPVwibGV0IGRheSBvZiB3ZWVrXCI+XG5cbiAgICAgIDwhLS0gRGF5IGNvbnRlbnQgLS0+XG4gICAgICA8ZGl2IGNsYXNzPVwibGFiZWxfX2NvbnRlbnRcIj5cblxuICAgICAgICA8bmctY29udGFpbmVyICpuZ1RlbXBsYXRlT3V0bGV0PVwiZGF5VGVtcGxhdGUgPyBkYXlUZW1wbGF0ZSA6IGRlZmF1bHREYXlUZW1wbGF0ZTsgY29udGV4dDogeyAkaW1wbGljaXQ6IGRheSB9XCI+PC9uZy1jb250YWluZXI+XG5cbiAgICAgIDwvZGl2PlxuXG4gICAgPC9kaXY+XG5cbiAgPC9kaXY+XG5cbjwvZGl2PlxuXG5cblxuPCEtLSBUZW1wbGF0ZXMgLS0+XG5cbjwhLS0gRGF5IHRlbXBsYXRlIC0tPlxuPG5nLXRlbXBsYXRlICNkZWZhdWx0RGF5VGVtcGxhdGVcbiAgICAgICAgICAgICBsZXQtZGF5PlxuICA8ZGl2IGNsYXNzPVwiZmxleC1leHBhbmRlZC1jb250YWluZXJcIj5cbiAgICA8ZGl2IFtuZ0NsYXNzXT1cIlsnZmxleC1leHBhbmQnLCBnZXRDbGFzc0ZvckRheShkYXkpXVwiPnt7IGdldEZvcm1hdHRlZERheShkYXkpIH19PC9kaXY+XG4gIDwvZGl2PlxuPC9uZy10ZW1wbGF0ZT5cblxuPCEtLSBEYXkgb2Ygd2VlayBjZWxscyB0ZW1wbGF0ZSAtLT5cbjxuZy10ZW1wbGF0ZSAjZGVmYXVsdERheU9mV2Vla1RlbXBsYXRlXG4gICAgICAgICAgICAgbGV0LWRheU9mV2Vla1xuICAgICAgICAgICAgIGxldC1kYXlPZldlZWtJbmRleD1cImRheU9mV2Vla0luZGV4XCI+XG4gIDxkaXYgW2NsYXNzLmZsZXgtZXhwYW5kZWQtY29udGFpbmVyXT1cImdyb3cubW9kZSAhPSAnbWl4ZWQnXCI+XG4gICAgPGRpdiBbbmdDbGFzc109XCJbJ2ZsZXgtZXhwYW5kJywgJ2ZsZXgtY2VudGVyZWQnLCBkYXlPZldlZWtDYXB0aW9uQ2xhc3NdXCI+XG4gICAgICB7eyBkYXlPZldlZWsgfX1cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG48L25nLXRlbXBsYXRlPlxuXG48IS0tIE1vbnRoIGNlbGwgdGVtcGxhdGUgLS0+XG48bmctdGVtcGxhdGUgI2RlZmF1bHRNb250aFRlbXBsYXRlXG4gICAgICAgICAgICAgbGV0LWRhdGU+XG4gIDxkaXYgW2NsYXNzLmZsZXgtZXhwYW5kZWQtY29udGFpbmVyXT1cImdyb3cubW9kZSAhPSAnbWl4ZWQnXCI+XG4gICAgPGRpdiBbbmdDbGFzc109XCJbJ2ZsZXgtZXhwYW5kJywgJ2ZsZXgtY2VudGVyZWQnLCBtb250aENhcHRpb25DbGFzc11cIj5cbiAgICAgIHt7IG1vbnRoQ2FwdGlvbiB9fVxuICAgIDwvZGl2PlxuICA8L2Rpdj5cbjwvbmctdGVtcGxhdGU+XG5gLFxuICBzdHlsZXM6IFtgLmNvbHVtbntkaXNwbGF5OmZsZXg7ZmxleC1mbG93OmNvbHVtbjtmbGV4OjF9LnJvd3tkaXNwbGF5OmZsZXg7ZmxleDoxfS5sYWJlbHtwb3NpdGlvbjpyZWxhdGl2ZX0ubGFiZWxfX2NvbnRlbnR7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO2JvdHRvbTowO3JpZ2h0OjB9LmZsZXgtZXhwYW5kZWQtY29udGFpbmVye2Rpc3BsYXk6ZmxleDtwb3NpdGlvbjphYnNvbHV0ZTt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfS5mbGV4LWV4cGFuZHtmbGV4OjF9LmZsZXgtY2VudGVyZWR7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtqdXN0aWZ5LWNvbnRlbnQ6Y2VudGVyfS5yYXRpby1oZWlnaHR7cGFkZGluZy1ib3R0b206MTQuMjg1NzElfS5yYXRpby1zcXVhcmV7cGFkZGluZy1ib3R0b206MTQuMjg1NzElO3dpZHRoOjE0LjI4NTcxJX0uc3RyZXRjaC12ZXJ0aWNhbGx5e2hlaWdodDoxMDAlfS5zdHJldGNoLWhvcml6b250YWxseXt3aWR0aDoxNC4yODU3MSV9LmZpeGVkLWhlaWdodHtkaXNwbGF5OmZsZXg7ZmxleDoxfS53LTEwMHt3aWR0aDoxMDAlfS5zYy1tb250aHtmb250LXNpemU6MnJlbX0uc2MtbW9udGgtLWRpc2FibGVke29wYWNpdHk6LjI1fS5zYy1tb250aF9fY2FwdGlvbiwuc2MtbW9udGhfX3dlZWstY2FwdGlvbntib3JkZXI6MXB4IHNvbGlkICMwMDA7Zm9udC13ZWlnaHQ6NzAwfS5zYy1tb250aF9fZGF5e2JvcmRlcjoxcHggc29saWQgIzAwMDtjdXJzb3I6cG9pbnRlcn0uc2MtbW9udGhfX2RheS0tZGlzYWJsZWR7Y3Vyc29yOmF1dG99LnNjLW1vbnRoX19kYXktLXRvZGF5e2JhY2tncm91bmQ6cGlua30uc2MtbW9udGhfX2RheS0tc2VsZWN0ZWR7YmFja2dyb3VuZDojNjQ5NWVkfWBdLFxuICBwcm92aWRlcnM6IFtNT05USF9DQUxFTkRBUl9WQUxVRV9BQ0NFU1NPUl1cbn0pXG5leHBvcnQgY2xhc3MgTW9udGhDYWxlbmRhckNvbXBvbmVudCBpbXBsZW1lbnRzIENvbnRyb2xWYWx1ZUFjY2Vzc29yLCBPbkluaXQge1xuICBAQ29udGVudENoaWxkKERheVRlbXBsYXRlRGlyZWN0aXZlLCB7IHJlYWQ6IFRlbXBsYXRlUmVmIH0pIGRheVRlbXBsYXRlO1xuICBAQ29udGVudENoaWxkKERheU9mV2Vla0NhcHRpb25UZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBkYXlPZldlZWtUZW1wbGF0ZTtcbiAgQENvbnRlbnRDaGlsZChNb250aENhcHRpb25UZW1wbGF0ZURpcmVjdGl2ZSwgeyByZWFkOiBUZW1wbGF0ZVJlZiB9KSBtb250aFRlbXBsYXRlO1xuXG4gIC8qKlxuICAgKiBFdmVudCByYWlzZWQgd2hlbiB0aGUgdXNlciBzZWxlY3RzIGEgZGF0ZS5cbiAgICovXG4gIEBPdXRwdXQoJ2NoYW5nZScpIGNoYW5nZSA9IG5ldyBFdmVudEVtaXR0ZXI8RGF0ZT4oKTtcblxuICAvKipcbiAgICogRXZlbnQgcmFpc2VkIHdoZW4gdGhlIHVzZXIgY2xpY2tzIHRoZSBjYWxlbmRhci5cbiAgICovXG4gIEBPdXRwdXQoJ21vbnRoQ2xpY2snKSBtb250aENsaWNrID0gbmV3IEV2ZW50RW1pdHRlcjxNb250aENhbGVuZGFyQ29tcG9uZW50PigpO1xuXG4gIC8qKlxuICAgKiBTZXRzIGlmIHRoZSBjb250cm9sIHNob3VsZCBiZSBpbiBhXG4gICAqIGRpc2FibGVkIHN0YXRlLlxuICAgKi9cbiAgQElucHV0KCkgZGlzYWJsZWQgPSBmYWxzZTtcblxuICAvKipcbiAgICogRGF0ZSB0byBzaG93LlxuICAgKi9cbiAgcHJpdmF0ZSBfdmFsdWUgPSBuZXcgRGF0ZSgpO1xuXG4gIGdldCB2YWx1ZSgpOiBEYXRlIHtcbiAgICByZXR1cm4gdGhpcy5fdmFsdWU7XG4gIH1cblxuICBASW5wdXQoKSBzZXQgdmFsdWUoZGF0ZTogRGF0ZSkge1xuICAgIHRoaXMud3JpdGVWYWx1ZShkYXRlKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTcGVjaWZpZXMgaG93IGEgZGF5IGNlbGwgc2hvdWxkIGdyb3cuXG4gICAqL1xuICBwcml2YXRlIF9ncm93OiBHcm93TW9kZSA9IHsgbW9kZTogJ3N0cmV0Y2gnIH07XG5cbiAgQElucHV0KCkgc2V0IGdyb3cgKG1vZGU6IEdyb3dNb2RlKSB7XG4gICAgaWYgKG1vZGUpIHtcbiAgICAgIHRoaXMuX2dyb3cgPSBtb2RlO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9ncm93ID0geyBtb2RlOiAnc3RyZXRjaCcgfTtcbiAgICB9XG4gIH1cblxuICBnZXQgZ3JvdygpOiBHcm93TW9kZSB7XG4gICAgcmV0dXJuIHRoaXMuX2dyb3c7XG4gIH1cblxuICBwcml2YXRlIGRlZmF1bHRGaXJzdERheU9mV2VlayA9IERheU9mV2Vlay5TdW5kYXk7XG5cbiAgcHJpdmF0ZSBkZWZhdWx0RGF5T2ZXZWVrQ2FwdGlvbkZvcm1hdHRlciA9IGRlZmF1bHREYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyRmFjdG9yeSh0aGlzLmRlZmF1bHRGaXJzdERheU9mV2Vlayk7XG5cbiAgLyoqXG4gICAqIEZpcnN0IGRheSBvZiB0aGUgd2Vlay5cbiAgICovXG4gIHByaXZhdGUgX2ZpcnN0RGF5T2ZXZWVrOiBEYXlPZldlZWsgPSB0aGlzLmRlZmF1bHRGaXJzdERheU9mV2VlaztcblxuICBASW5wdXQoKSBzZXQgZmlyc3REYXlPZldlZWsgKGRheU9mV2VlazogRGF5T2ZXZWVrKSB7XG4gICAgdGhpcy5fZmlyc3REYXlPZldlZWsgPSBkYXlPZldlZWs7XG4gICAgdGhpcy5kZWZhdWx0RGF5T2ZXZWVrQ2FwdGlvbkZvcm1hdHRlciA9IGRlZmF1bHREYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyRmFjdG9yeSh0aGlzLl9maXJzdERheU9mV2Vlayk7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gIH1cblxuICBnZXQgZmlyc3REYXlPZldlZWsoKTogRGF5T2ZXZWVrIHtcbiAgICByZXR1cm4gdGhpcy5fZmlyc3REYXlPZldlZWs7XG4gIH1cblxuICAvKipcbiAgICogRm9ybWF0dGVyIGZvciBkYXlzLlxuICAgKi9cbiAgcHJpdmF0ZSBfZGF5Rm9ybWF0dGVyOiAoZGF5PzogRGF5SW5mbykgPT4gc3RyaW5nO1xuXG4gIEBJbnB1dCgpIHNldCBkYXlGb3JtYXR0ZXIgKGZvcm1hdHRlcjogKGRheT86IERheUluZm8pID0+IHN0cmluZykge1xuICAgIHRoaXMuX2RheUZvcm1hdHRlciA9IGZvcm1hdHRlcjtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIGdldCBkYXlGb3JtYXR0ZXIoKTogKGRheT86IERheUluZm8pID0+IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMuX2RheUZvcm1hdHRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYXB0aW9ucyBvZiB0aGUgZGlmZmVyZW50IGRheXMgb2YgdGhlIHdlZWsuXG4gICAqL1xuICBkYXlzT2ZXZWVrQ2FwdGlvbnM7XG5cbiAgLyoqXG4gICAqIEZvcm1hdHRlciBmb3IgdGhlIGNhcHRpb25zIG9mIHRoZSBkaWZmZXJlbnRcbiAgICogZGF5cyBvZiB0aGUgd2Vlay5cbiAgICovXG4gIHByaXZhdGUgX2RheU9mV2Vla0NhcHRpb25Gb3JtYXR0ZXI6IChkYXlPZldlZWs6IERheU9mV2VlaykgPT4gc3RyaW5nO1xuXG4gIEBJbnB1dCgpIHNldCBkYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyIChmb3JtYXR0ZXI6IChkYXlPZldlZWs6IERheU9mV2VlaykgPT4gc3RyaW5nKSB7XG4gICAgdGhpcy5fZGF5T2ZXZWVrQ2FwdGlvbkZvcm1hdHRlciA9IGZvcm1hdHRlcjtcbiAgICB0aGlzLnJlZnJlc2goKTtcbiAgfVxuXG4gIGdldCBkYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyKCk6IChkYXlPZldlZWs6IERheU9mV2VlaykgPT4gc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fZGF5T2ZXZWVrQ2FwdGlvbkZvcm1hdHRlcjtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYXB0aW9uIG9mIHRoZSBtb250aC5cbiAgICovXG4gIG1vbnRoQ2FwdGlvbjtcblxuICAvKipcbiAgICogRm9ybWF0dGVyIGZvciB0aGUgbW9udGggY2FwdGlvbi5cbiAgICovXG4gIHByaXZhdGUgX21vbnRoQ2FwdGlvbkZvcm1hdHRlcjogKGRhdGU6IERhdGUpID0+IHN0cmluZztcblxuICBASW5wdXQoKSBzZXQgbW9udGhDYXB0aW9uRm9ybWF0dGVyIChmb3JtYXR0ZXI6IChkYXRlOiBEYXRlKSA9PiBzdHJpbmcpIHtcbiAgICB0aGlzLl9tb250aENhcHRpb25Gb3JtYXR0ZXIgPSBmb3JtYXR0ZXI7XG4gICAgdGhpcy5yZWZyZXNoKCk7XG4gIH1cblxuICBnZXQgbW9udGhDYXB0aW9uRm9ybWF0dGVyKCk6IChkYXRlOiBEYXRlKSA9PiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLl9tb250aENhcHRpb25Gb3JtYXR0ZXI7XG4gIH1cblxuICAvKipcbiAgICogUmV0cmlldmVzIGEgQ1NTIGNsYXNzIGZvciB0aGUgc3BlY2lmaWVkIGRheS5cbiAgICovXG4gIEBJbnB1dCgpIGN1c3RvbURheUNsYXNzOiAoZGF5OiBEYXlJbmZvKSA9PiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIENTUyBjbGFzcyBmb3IgdGhlIG1vbnRoLlxuICAgKi9cbiAgQElucHV0KCkgbW9udGhDbGFzcyA9ICdzYy1tb250aCc7XG5cbiAgLyoqXG4gICAqIENTUyBjbGFzcyBmb3IgdGhlIGRpc2FibGVkIHN0YXRlLlxuICAgKi9cbiAgQElucHV0KCkgZGlzYWJsZWRDbGFzcyA9ICdzYy1tb250aC0tZGlzYWJsZWQnO1xuXG4gIC8qKlxuICAgKiBDU1MgY2xhc3MgZm9yIHRoZSBtb250aCBjYXB0aW9uLlxuICAgKi9cbiAgQElucHV0KCkgbW9udGhDYXB0aW9uQ2xhc3MgPSAnc2MtbW9udGhfX2NhcHRpb24nO1xuXG4gIC8qKlxuICAgKiBDU1MgY2xhc3MgZm9yIHRoZSBkYXkgb2YgdGhlIHdlZWsgY2FwdGlvbnMuXG4gICAqL1xuICBASW5wdXQoKSBkYXlPZldlZWtDYXB0aW9uQ2xhc3MgPSAnc2MtbW9udGhfX3dlZWstY2FwdGlvbic7XG5cbiAgLyoqXG4gICAqIENTUyBjbGFzcyBmb3IgdGhlIGRheSBjYXB0aW9ucy5cbiAgICovXG4gIEBJbnB1dCgpIGRheUNhcHRpb25DbGFzcyA9ICdzYy1tb250aF9fZGF5JztcblxuICAvKipcbiAgICogQ1NTIGNsYXNzIGZvciB0aGUgY3VycmVudCBkYXkuXG4gICAqL1xuICBASW5wdXQoKSBjdXJyZW50RGF5Q2xhc3MgPSAnc2MtbW9udGhfX2RheS0tdG9kYXknO1xuXG4gIC8qKlxuICAgKiBDU1MgY2xhc3MgZm9yIHRoZSBkYXkgd2hlbiB0aGUgc3RhdGUgaXMgZGlzYWJsZWQuXG4gICAqL1xuICBASW5wdXQoKSBkaXNhYmxlZERheUNsYXNzID0gJ3NjLW1vbnRoX19kYXktLWRpc2FibGVkJztcblxuICAvKipcbiAgICogQ1NTIGNsYXNzIGZvciB0aGUgc2VsZWN0ZWQgZGF5LlxuICAgKi9cbiAgQElucHV0KCkgc2VsZWN0ZWREYXlDbGFzcyA9ICdzYy1tb250aF9fZGF5LS1zZWxlY3RlZCc7XG5cbiAgLyoqXG4gICAqIFZpZXcgb2YgdGhlIGN1cnJlbnQgbW9udGguXG4gICAqL1xuICB2aWV3O1xuXG4gIHByaXZhdGUgZGVmYXVsdE1vbnRoQ2FwdGlvbkZvcm1hdHRlciA9IChkYXRlOiBEYXRlKSA9PiBkYXRlLnRvRGF0ZVN0cmluZygpO1xuICBwcml2YXRlIGRlZmF1bHREYXlGb3JtYXR0ZXIgPSAoZGF5PzogRGF5SW5mbykgPT4gZGF5ID8gZGF5LmRheS50b1N0cmluZygpIDogJyc7XG4gIHByaXZhdGUgb25DaGFuZ2UgPSAoZGF0ZTogRGF0ZSkgPT4geyB9O1xuICBwcml2YXRlIG9uVG91Y2hlZCA9ICgpID0+IHsgfTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIGNvbXBvbmVudC5cbiAgICovXG4gIG5nT25Jbml0KCkge1xuICAgIHRoaXMucmVmcmVzaCgpO1xuICB9XG5cbiAgd3JpdGVWYWx1ZShkYXRlOiBEYXRlKTogdm9pZCB7XG4gICAgaWYgKGRhdGUpIHtcbiAgICAgIHRoaXMuX3ZhbHVlID0gZGF0ZTtcbiAgICAgIHRoaXMucmVmcmVzaCgpO1xuICAgICAgdGhpcy5vbkNoYW5nZShkYXRlKTtcbiAgICB9XG4gIH1cblxuICByZWdpc3Rlck9uQ2hhbmdlKGZuOiAoZGF0ZTogRGF0ZSkgPT4ge30pOiB2b2lkIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogKCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHRoaXMub25Ub3VjaGVkID0gZm47XG4gIH1cblxuICBzZXREaXNhYmxlZFN0YXRlKGlzRGlzYWJsZWQ6IGJvb2xlYW4pOiB2b2lkIHtcbiAgICB0aGlzLmRpc2FibGVkID0gaXNEaXNhYmxlZDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZWZyZXNoZXMgdGhlIGNvbXBvbmVudC5cbiAgICovXG4gIHByaXZhdGUgcmVmcmVzaCgpOiB2b2lkIHtcbiAgICB0aGlzLnJlZnJlc2hNb250aENhcHRpb24odGhpcy52YWx1ZSk7XG4gICAgdGhpcy5yZWZyZXNoRGF5T2ZXZWVrQ2FwdGlvbnMoKTtcbiAgICB0aGlzLnJlZnJlc2hWaWV3KHRoaXMudmFsdWUpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZnJlc2hlcyB0aGUgbW9udGggY2FwdGlvbi5cbiAgICogQHBhcmFtIGRhdGUgRGF0ZS5cbiAgICovXG4gIHByaXZhdGUgcmVmcmVzaE1vbnRoQ2FwdGlvbihkYXRlOiBEYXRlKTogdm9pZCB7XG4gICAgaWYgKHRoaXMubW9udGhDYXB0aW9uRm9ybWF0dGVyKSB7XG4gICAgICB0aGlzLm1vbnRoQ2FwdGlvbiA9IHRoaXMubW9udGhDYXB0aW9uRm9ybWF0dGVyKGRhdGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1vbnRoQ2FwdGlvbiA9IHRoaXMuZGVmYXVsdE1vbnRoQ2FwdGlvbkZvcm1hdHRlcihkYXRlKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVmcmVzaGVzIHRoZSBkYXkgb2Ygd2VlayBjYXB0aW9ucy5cbiAgICovXG4gIHByaXZhdGUgcmVmcmVzaERheU9mV2Vla0NhcHRpb25zKCk6IHZvaWQge1xuICAgIGNvbnN0IGRheUNhcHRpb25zOiBzdHJpbmdbXSA9IFtdO1xuXG4gICAgY29uc3QgZGF5T2ZXZWVrRm9ybWF0dGVyID0gdGhpcy5kYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyID9cbiAgICAgIHRoaXMuZGF5T2ZXZWVrQ2FwdGlvbkZvcm1hdHRlciA6XG4gICAgICB0aGlzLmRlZmF1bHREYXlPZldlZWtDYXB0aW9uRm9ybWF0dGVyO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBEQVlfTkFNRVMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGRheUNhcHRpb25zLnB1c2goZGF5T2ZXZWVrRm9ybWF0dGVyKGkpKTtcbiAgICB9XG5cbiAgICB0aGlzLmRheXNPZldlZWtDYXB0aW9ucyA9IGRheUNhcHRpb25zO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlZnJlc2hlcyB0aGUgY2FsZW5kYXIgdmlldy5cbiAgICogQHBhcmFtIGRhdGUgRGF0ZS5cbiAgICovXG4gIHByaXZhdGUgcmVmcmVzaFZpZXcoZGF0ZTogRGF0ZSk6IHZvaWQge1xuICAgIHRoaXMudmlldyA9IG5ldyBNb250aFZpZXcoZGF0ZSkuY3JlYXRlVmlldyhmYWxzZSwgdGhpcy5maXJzdERheU9mV2Vlayk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgQ1NTIGNsYXNzZXMgdG8gYXBwbHkgdG8gdGhlIG1vbnRoLlxuICAgKi9cbiAgZ2V0Q2xhc3NGb3JNb250aCgpOiBzdHJpbmcge1xuICAgIGxldCBjbGFzc2VzVG9BcHBseSA9IHRoaXMubW9udGhDbGFzcztcblxuICAgIGlmICh0aGlzLmRpc2FibGVkKSB7XG4gICAgICBjbGFzc2VzVG9BcHBseSA9IHRoaXMubW9udGhDbGFzcyArICcgJyArIHRoaXMuZGlzYWJsZWRDbGFzcztcbiAgICB9XG5cbiAgICByZXR1cm4gY2xhc3Nlc1RvQXBwbHk7XG4gIH1cblxuICAvKipcbiAgICogR2V0cyB0aGUgQ1NTIGNsYXNzIGFwcGxpY2FibGUgdG9cbiAgICogdGhlIHNwZWNpZmllZCBkYXkuXG4gICAqIEBwYXJhbSBkYXkgRGF5LlxuICAgKi9cbiAgZ2V0Q2xhc3NGb3JEYXkoZGF5PzogRGF5SW5mbyk6IHN0cmluZyB7XG4gICAgbGV0IGRheUNsYXNzVG9BcHBseSA9ICcnO1xuXG4gICAgaWYgKGRheSkge1xuXG4gICAgICBpZiAoZGF5LmRheSA9PT0gdGhpcy52YWx1ZS5nZXREYXRlKCkpIHtcbiAgICAgICAgZGF5Q2xhc3NUb0FwcGx5ID0gdGhpcy5zZWxlY3RlZERheUNsYXNzO1xuICAgICAgfSBlbHNlIGlmIChkYXkuaXNUb2RheSkge1xuICAgICAgICBkYXlDbGFzc1RvQXBwbHkgPSB0aGlzLmN1cnJlbnREYXlDbGFzcztcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5jdXN0b21EYXlDbGFzcykge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodGhpcy52YWx1ZS52YWx1ZU9mKCkpO1xuICAgICAgICBkYXRlLnNldERhdGUoZGF5LmRheSk7XG4gICAgICAgIGRheUNsYXNzVG9BcHBseSA9IHRoaXMuY3VzdG9tRGF5Q2xhc3MoZGF5KTtcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHtcbiAgICAgICAgZGF5Q2xhc3NUb0FwcGx5ID0gZGF5Q2xhc3NUb0FwcGx5ICsgJyAnICsgdGhpcy5kaXNhYmxlZERheUNsYXNzO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gdGhpcy5kYXlDYXB0aW9uQ2xhc3MgKyAnICcgKyBkYXlDbGFzc1RvQXBwbHk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmRheUNhcHRpb25DbGFzcztcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogR2V0cyBhIGZvcm1hdHRlZCBzdHJpbmcgY29ycmVzcG9uZGluZ1xuICAgKiB0byB0aGUgc3BlY2lmaWVkIGRheS5cbiAgICogQHBhcmFtIGRheSBEYXkgdG8gZm9ybWF0LlxuICAgKi9cbiAgZ2V0Rm9ybWF0dGVkRGF5KGRheTogRGF5SW5mbyk6IHN0cmluZyB7XG4gICAgaWYgKHRoaXMuZGF5Rm9ybWF0dGVyKSB7XG4gICAgICByZXR1cm4gdGhpcy5kYXlGb3JtYXR0ZXIoZGF5KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuZGVmYXVsdERheUZvcm1hdHRlcihkYXkpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDb250cm9scyB0aGUgY2xpY2sgZXZlbnQgb2YgYSBkYXkgY2VsbC5cbiAgICogQHBhcmFtIGRheUluZm8gSW5mbyBhYm91dCB0aGUgc2VsZWN0ZWQgZGF5LlxuICAgKi9cbiAgb25EYXlDbGljayhkYXlJbmZvOiBEYXlJbmZvKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmRpc2FibGVkICYmIGRheUluZm8pIHtcbiAgICAgIGNvbnN0IHNlbGVjdGVkRGF0ZSA9IG5ldyBEYXRlKHRoaXMudmFsdWUudmFsdWVPZigpKTtcbiAgICAgIHNlbGVjdGVkRGF0ZS5zZXREYXRlKGRheUluZm8uZGF5KTtcblxuICAgICAgdGhpcy52YWx1ZSA9IG5ldyBEYXRlKHNlbGVjdGVkRGF0ZS52YWx1ZU9mKCkpO1xuXG4gICAgICB0aGlzLmNoYW5nZS5lbWl0KHNlbGVjdGVkRGF0ZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbnRyb2xzIHRoZSBjbGljayBldmVudCBvZiB0aGUgbW9udGguXG4gICAqL1xuICBvbk1vbnRoQ2xpY2soKTogdm9pZCB7XG4gICAgaWYgKCF0aGlzLmRpc2FibGVkKSB7XG4gICAgICB0aGlzLm1vbnRoQ2xpY2suZW1pdCh0aGlzKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==